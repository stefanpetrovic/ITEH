YModules={};YUI.add("module_platform",function(K){var i,T=K.Lang,ac=K.Array,an=K.Object,av=T.isString,G=T.isUndefined,aq=T.isBoolean,ao=T.isFunction,t=T.isObject,a=T.isArray,P=T.later,F=true,p=false,X=null,at=0,w=X,U=X,ak=X,ar={},W={},af={},aj={},ah=[],N={init:function(){}},O=["closeView","hideView","isViewOpen","openView","openViewHtml","refreshView","showView","setView"],h="modulestart",y="viewload",ag="viewunload",aA="started",aw="props",n="config",J="res",ay="resourcemgr",V="signal",I="state",ae="message",Q="MPServices",B="ModulePlatformProvider";function al(aB,L,Y){if(!t(L)){L=new Error(L);}if(U.debug){throw L;}else{var A={type:"error",errorType:aB,error:L};if(t(Y)){K.mix(A,Y);}i.fire(A);}}function R(A,L){return t(ar[A])?ar[A].getService(i,L):X;}function D(aB,Y,A){if(A){var L=an(A);an.each(A,function(aC,aD){if(ao(aC)&&!U.debug){L[aD]=function(){try{return aC.apply(this,arguments);}catch(aE){al(aD,aE,{moduleId:aB});}};}});return L;}else{return N;}}function ai(L,A,Y){f(A,"viewevent",[Y,L]);}function ab(aB,Y){var aC=af[aB],aE,A,aD,L;if(aC){if(!aC[aA]){aE=aC[n];L=aE[aw];A=YModules[L.ns];aD=aE[I];aC.module=D(aB,L.type,A);aC.module.init(aC.api);aC[aA]=F;if(Y&&aD&&av(aD.view)){f(aB,y,[aD.view]);}i.fire({type:h,moduleId:aB});}}}function l(A){var L=ah.shift();ab(L,A);if(ah.length){ak=P(0,X,l,[A]);}else{if(at==1){at=4;i.fire({type:"ready"});}ak=X;}}function o(Y,L){var A=Y[L];delete Y[L];return A;}function ap(Y,A,aB){i.fire({type:ae,messageName:A,moduleId:Y,data:aB});var L=aj[A];if(L){an.each(L,function(aD,aC){f(aC,ae,[A,af[Y].api.getProperty("type"),aB]);});}}function az(L,A,Y){i.fire({type:"navigate",moduleId:L,url:A,target:Y});}function E(L,A){if(!(A instanceof Array)){A=[A];}ac.each(A,function(Y){if(!aj[Y]){aj[Y]={};}aj[Y][L]=1;i.fire({type:"listen",moduleId:L,messageName:Y});});}function H(L,A){if(A&&!(A instanceof Array)){A=[A];}else{A=an.keys(aj);}ac.each(A,function(Y){if(aj[Y]){delete aj[Y][L];i.fire({type:"unlisten",moduleId:L,messageName:Y});}});}function f(L,aD,aF){if(!av(L)){al(V,"Module ID must be a string.");return F;}else{if(!af[L]){al(V,"No module information for module ("+L+"), couldn't signal ("+aD+")");return F;}}aF=aF||[];var aK=F,A=af[L],aH=A.module,aG=A[aA],aE=A.api,aI=aF[0],aB=A.handlers,Y,aJ,aC;if(aG){if(aD==y||aD==ag){Y=aE.getViewNode(aF[0]);aC=aH.viewevents||[];if(!aB[aI]){aB[aI]=[];}if(aD==y){if(aC.length){if(Y){ac.each(aC,function(aL){aB[aI].push(Y.on(aL,K.rbind(ai,i,L,aI)));});}else{al(V,"Module missing a node for '"+aI+"' view",{moduleId:L});}}}else{if(aB[aI]){aJ=aB[aI].pop();while(aJ){aJ.detach();aJ=aB[aI].pop();}}}}i.fire({type:"modulesignal",signal:aD,moduleId:L,args:aF});aD="on"+aD;if(aH[aD]){aK=aH[aD].apply(aH,aF);if(aq(aK)){}else{aK=F;}}else{}}else{}return aK;}function u(){return U;}function Z(A){return G(af[A])?X:af[A].api;}function q(A){return G(af[A])?X:af[A][n][I]||X;}function m(A){return U[aw][A];}function e(L,A){return R(ay).getString(L,A);}function k(A,L){return W[L]?W[L].getViewDirection(A):X;}function ax(A,L){return W[L]?W[L].getViewNode(A):X;}function c(A){ar[A.name]=A;}function C(A){return o(ar,A);}function aa(A){return !!af[A];}function ad(aF){var Y=aF[aw],L=aF.mods,aC=Y.id,aE=R(ay),aB=YModules[Y.ns],A,aD;if(af[aC]){A=af[aC].config;ac.each(["strs","data","prefs"],function(aG){if(!A[aG]){A[aG]={};}K.mix(A[aG],aF[aG],F);});A.mods=aF.mods;}else{af[aC]={config:aF,api:K.ModuleApi(i,aF),started:p,handlers:{}};aE.setLoaded(aF[J]);}aE.setStrings(Y.type,aF.strs);if(a(L)){ac.each(L,ad);}if(av(Y.parentId)){aD=af[Y.parentId].config;if(!a(aD.mods)){aD.mods=[];}if(ac.indexOf(aD.mods,aF)==-1){aD.mods.push(aF);}}if(Y.trusted&&aB&&a(aB.services)){ac.each(aB.services,c);}}function v(L){var A=af[L];if(A){if(A[aA]){al("unregisterModule","Module "+L+" must be stopped before being unregistered.",{moduleId:L});}ac.each(b(L),v);delete af[L];}else{}}function S(L,aC){var aB=R("transport"),Y=aC.success||function(){},A=aC.scope||X;aC.success=function(aD,aE){ad(aD.mod);aD.data=aD.data||{};aD.data.moduleId=aD.mod.props.id;delete aD.mod;Y.call(A,aD,aE);};aB.makeRequest(K.merge({type:"loadmodule"},L),aC);}function z(A){W[A.name]=A.create(i);}function d(A){return o(W,A);}function au(L){var A=[];an.each(af,function(Y,aB){if(L(aB)){A.push(aB);}});return A;}function s(){return au(function(){return F;});}function b(aB){var L=af[aB],Y=L?L.config.mods:X,A=[];if(U&&a(Y)){ac.each(Y,function(aC){A.push(aC.props.id);});}return A;}function g(L,Y){var A=[];ac.each(Y,function(aB){A.push(af[aB].config);});af[L].config.mods=A;}function x(A){return af[A]&&!!af[A][aA];}function r(A){ah.push(A);ac.each(b(A),r);}function j(A,Y,L){if(av(A)){A=[A];Y=(aq(Y)?Y:p);}else{if(A instanceof Array){Y=(aq(Y)?Y:F);}else{return;}}if(Y){ac.each(A,r);if(ak===X){ak=P(0,X,l,[L]);}}else{ac.each(A,function(aB){ab(aB,L);j(b(aB),Y,L);});}}function am(A){var Y=R("transport"),L;if(av(A)){A=[A];}ac.each(A,function(aB){var aC=af[aB];Y.abortModuleRequests(aB);an.each(W,function(aD,aE){i.closeView(aB,aE);});if(x(aB)){f(aB,"destroy");aC[aA]=p;aC.module=X;H(aB);i.fire({type:"modulestop",moduleId:aB});L=b(aB);if(a(L)){am(L);}}});}function M(){var A=s();am(A);ac.each(A,v);at=0;w.detachAll();w.fired=false;}i={error:al,getConfig:u,getModuleApi:Z,getModuleState:q,getProperty:m,getService:R,getString:e,getModules:s,getChildModules:b,setChildModules:g,queryModules:au,isStarted:x,start:j,stop:am,reset:M,broadcast:ap,listen:E,unlisten:H,navigate:az,signal:f,getViewDirection:k,getViewNode:ax,registerService:c,unregisterService:C,registerViewType:z,unregisterViewType:d,isModuleRegistered:aa,loadModule:S,registerModule:ad,unregisterModule:v};K.augment(i,K.EventTarget);w=i.publish("ready",{fireOnce:true});K.ModulePlatform={BaseViewType:{getViewDirection:function(){return X;},getViewNode:function(){return X;}},init:function(L,A){U=L||{};if(L){R(ay).setLoaded(U[J]);if(U.mods){ac.each(U.mods,function(Y){ad(Y);if(!Y[I]||!Y[I].defer){j(Y[aw].id,F,A);}});}at=1;this.fire({type:"init"});}}};ac.each(O,function(A){i[A]=function(){var Y=arguments,L=function(){var aE=arguments,aF=aE[0],aD=aE.length==3?[aF,aE[2]]:[aF],aC=W[aE[1]];return aC?aC[A].apply(aC,aD):p;};if(U.debug){return L.apply(this,Y);}else{try{return L.apply(this,Y);}catch(aB){al(A,aB,{moduleId:Y[0],view:Y[1]});}}};K.ModulePlatform.BaseViewType[A]=function(){return p;};});K.mix(K.ModulePlatform,i);K.namespace(Q);K[Q][B]={name:"moduleplatform",getService:function(A,Y){if(!Y){return A;}else{var L=A.getModuleApi(Y);return(L&&L.getProperty("trusted")?i:X);}}};K.ModulePlatform.registerService(K[Q][B]);},"1.0",{requires:["event-base"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("resourcemgr",function(b){var t=null,i=true,c={},p={},r={},u={},s=t,l=t,m=0,v=t,d={},n=b.ModulePlatform,g=b.Object,k=b.Lang,e,h="MPServices",o="ResourceMgrProvider";function j(x){var w=u[x];if(!k.isUndefined(w)){w();delete u[x];}delete p[x];e.fire({type:"complete",target:e,id:x});}function q(w){if(w.data.js){b.use("*",b.bind(a,this,w));}else{a(w);}}function a(B){var C=B.data.id,A=B.data.pkgs,z=t,y,w;for(y=0,w=A.length;y<w;y++){z=A[y];r[z]=1;delete c[z];b.Object.each(p,function(x,D){if(x[z]){delete p[D][z];}if(f(D)){j(D);}},this);}}function f(w){return(b.Object.size(p[w])==0);}e={_clearAll:function(){r={};c={};},getString:function(x,w){return d[x+"_"+w]||t;},isLoaded:function(w){return !!r[w];},load:function(y,D){var w=m++,C={js:{urls:[],names:[]},css:{urls:[],names:[]}},x,E,A,z,B;if(D){u[w]=D;}p[w]={};b.Array.each(["js","css"],function(F){E=C[F];A=[];g.each(y[F],function(G,H){if(c[H]){c[H].push(w);p[w][H]=1;}else{if(!r[H]){c[H]=[w];p[w][H]=1;E.names.push(H);if(G.indexOf("http")!==0){if(l){A.push(G);}else{E.urls.push(s+G);}}else{E.urls.push(G);}}}});if(A.length>0){E.urls.unshift(l+A.join("&"));}});if(f(w)){j(w);}else{z=C.js.urls;B=C.css.urls;if(z.length||B.length){if(B.length){x=b.Get.css(B,{onSuccess:q,scope:this,data:{id:w,pkgs:C.css.names}});}if(z.length){x=b.Get.script(z,{onSuccess:q,scope:this,data:{id:w,js:true,pkgs:C.js.names}});}this.fire({type:"start",target:this,id:w});}}},setLoaded:function(w){if(w){g.each(w.js,function(x,y){r[y]=i;});g.each(w.css,function(x,y){r[y]=i;});}},setStrings:function(w,x){g.each(x,function(z,y){d[w+"_"+y]=z;});}};b.augment(e,b.Event.Target);b.namespace(h);b[h][o]={name:"resourcemgr",getService:function(x,w){if(!v){v=x;s=v.getProperty("libRoot");l=v.getProperty("comboRoot");}return w?t:e;}};if(n){n.registerService(b[h][o]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
window.transportEval=function(code){return eval("("+code+")");};YUI.add("transport",function(W){var f="MPServices",N="TransportProvider",aC="transport",ao="POST",o="GET",w="proxyUrl",aM="proxyTimeout",x="DaliRequestWs",m="module",aE="cfg.dali.handler.ws",aN="cfg.maple_dali.handler.add",ac="INVALID_CRUMB",aD=aN,I=x,au="ok",am="post",r="pr",z="dt",q="rt",ak="default",ae="response",i="request",a="server",aA="browser",aa="crumb",av="abort",an="timeout",s=a,A="nocookies",U="badcrumb",y="badformat",u=2,aw=1,n=0,b=i,ar=ae,aK=av,L="failure",t="success",Q="failure",C="error",aB=15000,ab=1500,j=2,c=5,p="Gateway Timeout",Z=W.Lang,aG=Z.isString,ay=Z.isFunction,B=Z.isObject,S=Z.isUndefined,aL=Z.isNull,d=Z.isArray,P=Z.isNumber,aI=null,e=false,ad={},al=null,G=n,K=null,v={},l=W.ModulePlatform,h=/Content-Type\:\s([^\n]+)/,E=/boundary=([^\n\s]+)\;/,ag=/\{[^\n]+\}/,at=/Content-ID\:\s([0-9]+)/,O={tData:{},rData:{}};RequestBlackboard=function(){var Y={};var aO=1;return{create:function(aP){Y[aO]=aP;return aO++;},remove:function(aP){if(Y[aP]){delete (Y[aP]);return true;}else{return false;}},setProp:function(aR,aP,aQ){if(Y[aR]){Y[aR][aP]=aQ;}else{return false;}},getProp:function(aQ,aP){if(!S(Y[aQ])){return Y[aQ][aP];}else{return false;}},queryAll:function(aP){var aT=[];for(var aQ in Y){if(Y.hasOwnProperty(aQ)){var aS=Y[aQ];if(!S(aS)&&aP(Y[aQ])){Y[aQ].txId=aQ;var aR=Y[aQ];aT.push(Y[aQ]);}}}return aT;},getByTx:function(aQ){var aP=aQ;return this.queryAll(function(aR){if(aR.transactionId==aP){return true;}else{return false;}});},get:function(aP){return Y[aP];},reset:function(){aO=1;Y={};O={tData:{},rData:{}};},getSize:function(){if(aO===1){return 0;}var aQ=0;for(var aP in Y){aQ++;}return aQ;},_requestStore:Y};}();var aF=function(){var Y=[];return{enqueue:function(aO){return Y.push(aO);},next:function(){return Y.shift();},peek:function(){return Y[0];},getSize:function(){return Y.length;},reset:function(){Y=[];}};}();function H(){l=W.ModulePlatform;aI=null;RequestBlackboard.reset();aF.reset();aj.reset();al=R;ad[m]=aH;ad[x]=ax;G=n;if(ay(e.cancel)){e.cancel();}}function T(){return new Date();}var ah={disable:function(Y){G=Y?u:aw;},enable:function(){if(G===u){af();}G=n;},isEnabled:function(){return(G==n);},setRequestFormatter:function(Y,aO){ad[Y]=aO;},setResponseFormatter:function(Y){al=Y;},abortRequest:function(aO,Y){if((!Y)||Y==RequestBlackboard.getProp(aO,"moduleId")){F(aO);this.fire(aK,{type:av,response:{}});return aq(aO,Q,av,"");}else{return false;}},abortModuleRequests:function(Y){var aO=RequestBlackboard.queryAll(function(aP){return aP.originId==Y;});W.Array.each(aO,function(aP){this.abortRequest(aP.txId,Y);},this);},isRequestPending:function(aP,aO){if(aO){var Y=RequestBlackboard.get(aP);return(B(Y)&&(Y.moduleId==aO));}else{return(RequestBlackboard.get(aP))?true:false;}},makeRequest:function(aP,aR,aQ){if(G!==aw){if(d(aP)&&aP.length>1){for(var aO=0,Y=aP.length;aO<Y;aO++){g(aP[aO],aR,aQ);}return null;}else{return g((d(aP)?aP[0]:aP),aR,aQ);}}else{return false;}},getMetrics:function(Y){return(B(O.rData[Y])?O.rData[Y]:null);},clearMetrics:function(aO){if(aO){delete (O.rData[aO]);}else{var Y=RequestBlackboard.get(aO);if(RequestBlackboard.getSize()>0){O.rData={};}else{O={tData:{},rData:{}};}}},_simulateResponse:function(aS,aP,aR){var aQ="";var Y=aj.simulateResponse;if(aP._raw){Y(1,{status:200,statusText:"OK",responseText:aP._raw});return;}if(aP._result){switch(aP._result){case"abort":Y(1,{status:0,statusText:aP._result},1);break;case"timeout":Y(1,{status:0,statusText:aP._result},1);break;case"ok":aQ='[{"txId":'+aS+',"status":200,"statusText":"OK", "data":';if(aP.html){aQ+='"html":"'+aP.html+'",';}aQ+='{"mods":[{"props":{}}]}}]';var aO='{"props":{}, "status":"OK", "resps":'+aQ+"}";Y(1,{status:200,statusText:"OK",responseText:aO},1);break;case C:if(aP._resultDetail&&aP._resultDetail=="badcrumb"){aQ="[]";Y(1,{status:200,statusText:"ok",responseText:'{"props":{}, "status":400, "statusText":"Bad Request", "resps":'+aQ+"}"},false);return true;}else{if(aP._resultDetail&&aP._resultDetail=="nocookies"){aQ="[]";Y(1,{status:200,statusText:C,responseText:'{"props":{}, "status":400, "statusText":"Bad Request", "resps":'+aQ+"}"},true);return true;}}aQ='[{"txId":'+aS+',"status":404,"statusText":"ERROR", "data":{"mods":[{"props":{}}]}}]';Y(1,{status:404,statusText:"File not Found",responseText:"<html><head><title>404</title></head><body><p>File not found</p></body></html>"},false);break;}}},_reset:H};function aJ(Y){var aQ=W.Object(Y.data);var aP=false;var aO=false;aQ.getResponseHeader=function(aV){if(!aP){this.responseHeader=aQ.responseHeader.replace("\r\n","\n");aO=true;var aS=aQ.responseHeader.split("\n");var aR=aS.length;aP={};for(var aT=0;aT<aR;aT++){var aU=aS[aT].split(": ");aP[aU[0]]=aU[1];}}return aP[aV];};aQ.getAllResponseHeaders=function(){if(!aO){this.responseHeader=aQ.responseHeader.replace("\r\n","\n");}return this.responseHeader;};return W.mix(Y,aQ);}var az=function(aO,Y){if(aO.data&&aO.data.responseText){return aJ(aO);}else{if(aO.data){if(aO.data.mods){aO.mods=aO.data.mods;aO.mod=aO.mods[0];delete (aO.data.mods);}if(aO.data.html){aO.html=aO.data.html;delete (aO.data.html);}if(aO.data.res){aO.res=aO.data.res;delete (aO.data.res);}}return aO;}};function R(aO,Y){return aO;}al=R;function F(Y){if(!RequestBlackboard.getProp(Y,"isBatch")){var aO=RequestBlackboard.getProp("transactionObject");if(B(aO)&&aO.isInProgress()){aO.abort();}}else{}}function aq(aW,aT,aY,aR){var aO=RequestBlackboard.get(aW);if(S(aO)){return false;}var aP=aO.response||{},aU=null,a4=null;aP.result=aY||au;aP.resultDetail=aR||"";aP.originId=aO.originId||null;aP.targetId=aO.targetId||aO.originId;if(aO.html){aP.html=aO.html;}ah.fire(ar,{type:ar,response:aP});if(B(aP.data)){a4=aP.data.res;aU=aP.data.mods;}if(B(aU)){if(aU[0].state&&aU[0].state.defer){if(!ap(aW,aU[0].state)){RequestBlackboard.remove(aW);aP.status=504;aP.statusText=p;aT=Q;}else{return;}}for(var a1=0,Y=aU.length;a1<Y;a1++){if(aU[a1].props&&aU[a1].props.id){aI.registerModule(aU[a1]);}}}aP=az(aP);aP=al(aP,aI);var aZ=aO.cb,aV,aQ=this,a3=null;if(O.tData[aO.transactionId]&&aY==au){a3=O.tData[aO.transactionId];O.rData[aW]={rt:a3.rt,pr:a3.pr,dt:0};}if(!S(aZ.argument)){aP.argument=aZ.argument;aV=aZ.argument;}if(ay(aZ[aT])){var aS=W.bind(aZ[aT],aZ.scope||this,aP,aV);if(B(a4)){var a2=aI.getService("resourcemgr"),aX=null;if(a3){aX=T();var a0=O.rData[aW];}a2.load(a4,function(){if(a3){a0.dt=T()-aX;}aS();});}else{aS();}}return RequestBlackboard.remove(aW);}function ap(aR,aQ){var Y=RequestBlackboard.get(aR);var aS=RequestBlackboard.getProp(aR,"retries");if((aS>(c))){return false;}var aO=aQ.retryCount||c;var aP=aQ.retryInterval;aS=(P(aS))?aS:0;if(aS<aO){++aS;W.Lang.later(aP,this,function(){RequestBlackboard.setProp((g(Y.requestObject,Y.cb,Y.originId)),"retries",aS);});RequestBlackboard.remove(aR);return true;}else{return false;}}function X(aP,aW,aQ){var Y=aP.txId;var aO=RequestBlackboard.get(Y);if(S(aO)){return;}var aR=true;var aU={data:aP.data};var aY,aV;var aS=aO.cb;if(aP.status==200||aP.status==201){aU.status=au;aU.result=au;aY=au;aR=false;}else{aU.status=C;aU.result=C;if(aP.status==400){var aT=aa,aX="Invalid crumb.";aV=U;aY=C;if(!window.navigator.cookieEnabled||aQ=="badcookie"){aT=aA;aV=A;aX="Cookies are disabled";}aI[C](aT,aX);}}RequestBlackboard.setProp(Y,ae,aU);aq(Y,((aR)?Q:t),aY,aV);}function J(Y,aR,aO){var aQ=null,aP=aO||false;if(Y.resps&&Y.resps.length===0){aQ=RequestBlackboard.getByTx(aR);W.Array.each(aQ,function(aU){var aT=aa,aS=U;if(!window.navigator.cookieEnabled||(aP===true)){aT=aA;aS=A;}aI[C](aT,"A crumb error occured: ",Y);aq(aU.txId,Q,C,aS);},this);}else{W.Array.each(Y.resps,function(aS){aI[C](aa,"A crumb error occured: ",Y);aS.status=400;X(aS,ioResponseObj);},this);}delete (v[aR]);}function V(bg,aX,aO){var aT=aO||false,a7=aX.status,bb=bg,a3="",a1=C;if(a7!=200&&a7!=201&&a7!=au){if(a7===0){a1=(aX.statusText==an)?an:av;}else{a3=a;aI[C](a,"A server error occured: ",{responseObject:aX});}var a2=RequestBlackboard.getByTx(bb);W.Array.each(a2,function(bc){if(O.rData[bc.txId]){delete (O.rData[bc.txId]);}aq(bc.txId,Q,a1,a3);});}else{O.tData[bg].startParse=T();var aZ=aX.responseText;var be=aX.getResponseHeader("Content-Type");if(be.indexOf("Multipart/Related")!==-1){var a0=E.exec(be),aQ=aX.responseText.split("--"+a0[1]),ba=aQ.length;for(var a9=1;a9<ba;a9++){var aP=aQ[a9],a6=h.exec(aP),aS=a6[1];if(aS.match(/application\/json/)){var aY=aP.match(ag)[0];aZ=aY;}else{if(aS.match(/text\/html/)){var bh=at.exec(aP),bd=bh[1],aR=aP.substring(aP.search(/\n\n/));aR=Z.trim(aR);RequestBlackboard.setProp(bd,"html",aR);}}}}var aV;try{aV=window.transportEval(aZ);}catch(bf){aI[C](a,"A parse error occured: "+bf.message,bf);var a5=RequestBlackboard.getByTx(bg);W.Array.each(a5,function(bc){aq(bc.txId,Q,C,y);},this);return;}if(!B(aV)){result=C;resultDetail=y;aI[C](a,"A parse error occured: ",aX);var aW=RequestBlackboard.getByTx(bg);W.Array.each(aW,function(bc){aq(bc.txId,Q,result,resultDetail);},this);return;}switch(aV.status){case ac:try{K.dali.crumb=aV.props.dali.crumb;}catch(a8){J(aV,bg,badcoookie);return;}var aU=v[bg];if(S(aU.cfg.retries)){aU.cfg.retries=1;}else{++aU.cfg.retries;}if(aU.cfg.retries<j){var Y=k(aU.cfg,aU.forcepost);var a4=RequestBlackboard.getByTx(bg);W.Array.each(a4,function(bc){bc.transactionId=Y.id;},this);delete (v[bg]);}else{J(aV,bg,aO);}break;case 400:J(aV,bg,aO);break;default:delete (v[bg]);O.tData[bg].pr=T()-O.tData[bg].startParse;W.Array.each(aV.resps,function(bc){X(bc,aX,aT);},this);break;}}}var aj=function(){var aP=null,aO={};function Y(aU,aT,aR){var aS=(new Date())-aO[aU];O.tData[aU]={rt:aS,pr:null};V(aU,aT,aR);}function aQ(aR){aO[aR]=new Date();}return{execute:function(aT,aW,aX){if(!aP){var aV=aI.getProperty(aM);if(!S(aV)){aP=aV;}else{aP=aB;}}var aS=am+"="+encodeURIComponent(aW);aT=(aX==o)?D(aT,"&__r="+new Date().getTime()):aT;var aR={method:aX,data:aS,on:{success:Y,failure:Y,start:aQ},timeout:aP};var aU=W.io(aT,aR);return aU;},simulateResponse:function(aT,aR,aS){aR.getResponseHeader=function(){return"";};if(aS){Y(aT,aR,true);}else{Y(aT,aR,false);}},reset:function(){aO={};v={};}};}();function D(Y,aO){return Y+((Y.indexOf("?")==-1)?"?":"&")+aO;}var ax=function(Y){var aP=aE,aQ=Y.batchable||false;if(S(Y.method)){Y.method="get";}var aO=false;switch(Y.method.toUpperCase()){case ao:aO=true;var aR=Y.data;if(!aG(aR)){aI[C](aC,"data must be a string");}else{Y.data=aR;}break;case (o||"DELETE"):if(Y.data!==undefined&&aG(Y.data)){Y.url=D(Y.url,Y.data);}break;default:}return{handler:aP,data:Y,batchable:aQ,forcepost:aO,targetId:Y.url};};var aH=function(aQ,aR,Y){var aO=aQ.args||{};var aP=aQ.moduleId||null;aO.moduleId=aP;if(aO.maple){aO.maple.module=aP;}else{aO.maple={module:aP};}return{handler:aN,data:aO,batchable:aQ.batchable||false};};ad[m]=aH;ad[x]=ax;function M(aQ,aP){var aO=aP.requestObject;var Y=aO.type||I;aO=(ay(ad[Y]))?ad[Y](aO,aP.moduleId,aI):aO;aO.txId=aQ;if(Y==x&&S(aP.targetId)){aP.targetId=aO.targetId;}if(S(aO.handler)){aO.handler=aD;}return aO;}function g(aO,Y,aR){var aP={requestObject:aO,cb:Y,moduleId:aR,originId:aR};if(aO.moduleId){aP.targetId=aO.moduleId;}var aQ=RequestBlackboard.create(aP);if(aO.batchable!==true&&G===n){af(aQ);}else{aF.enqueue(aQ);if(aO.batchable===true){if(!e){e=W.later(1,this,af);}else{e.cancel();e=W.later(1,this,af);}}else{if(G===n){af();}}}return aQ;}function k(aR,aS){var aO=aI.getProperty(w);if(aL(K)){K={};K.dali=aI.getProperty("dali")||{};}var aP=W.JSON.stringify({reqs:aR,props:K});var Y="GET";if((encodeURIComponent(aP).length>ab)||aS){Y="POST";}var aQ=aj.execute(aO,aP,Y);v[aQ.id]={ioObj:aQ,cfg:aR,forcepost:aS};return aQ;}function af(aV){var aO=false;var aW=[];var aS=[];var aU=false;if(aV){var aT=RequestBlackboard.get(aV);ah.fire(b,{type:b,request:aT.requestObject,originId:aT.originId});var Y=M(aV,aT);aW.push(Y);if(Y.forcepost===true){aU=true;}RequestBlackboard.setProp(aV,"isBatch",false);aS[0]=aV;}else{if(ay(e.cancel)){e.cancel();}var aX=aF.next();while(aX){var aQ=RequestBlackboard.get(aX),aR=false;if(aQ){ah.fire(b,{type:b,request:aQ.requestObject,originId:aQ.originId});aQ=M(aX,aQ);if(aQ.batchable!==true){if(aQ.forcepost===true){aR=true;}tx=k([aQ],aR);RequestBlackboard.setProp(aX,"transactionId",tx.id);RequestBlackboard.setProp(aX,"transactionObject",tx);aO=true;}else{if(aQ.forcepost===true){aU=true;}aW.push(aQ);aS.push(aX);}}aX=aF.next();}}if(aW.length>=1){var aP=k(aW,aU);W.Array.each(aS,function(aY){RequestBlackboard.setProp(aY,"transactionId",aP.id);RequestBlackboard.setProp(aY,"transactionObject",aP);aO=true;});}}function ai(){RequestBlackboard.reset();aF.reset();aj.reset();O={tData:{},rData:{}};}W.on("unload",ai,window);W.augment(ah,W.Event.Target);W.namespace(f);W[f][N]={name:"transport",getService:function(aO,Y){if(Y){return null;}if(!aI){aI=aO;}return ah;}};if(l){l.registerService(W[f][N]);}},"1.6.1",{requires:["event","io"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("metro_dali",function(b){var a=b.ModulePlatform;a.subscribe("init",function(){var f=a.getService("transport"),e=0,d="cfg.maple_dali.handler.add",c="cfg.maple_dali.handler.refresh";f.setResponseFormatter(function(g){if(g.mod){g.data=g.mod.data;}if(g.data){delete g.data.maple;}return g;});f.setRequestFormatter("arcade",function(h,i){var g=b.mix({},h),j=h._id;delete g.type;if(!j){j=i;}if(h._type){j=h._type;}return{handler:c,data:{maple:{module:j,ba:b.merge(g,{_txnid:e++,_mode:"json",_id:j,_container:0,chrome:"false"})}}};});f.setRequestFormatter("loadview",function(k,j){var g=b.mix({},k),i=a.queryModules(function(p){var o=a.getModuleApi(p);return o&&o.getProperty("type")=="pa";})[0],m,n=k.moduleId,h=n,l=a.getModuleApi(n);switch(g.view){case"pa":g={handler:c,data:{maple:{module:i,ba:{_action:"show",_subAction:"single",modId:n,chrome:(g.chrome?"true":"false"),_txnid:e++,_mode:"json",_id:i,_container:(g.chrome?1:0),data:(g.data?g.data:null),cpos:l.getProperty("cpos")||undefined,pointer:(l.isViewOpen("default")||l.isViewOpen("edit"))?1:undefined}}},batchable:true};break;case"default":if(g.chrome){if(i){m=a.queryModules(function(q){var p=a.getModuleApi(q),o=p&&p.getProperty("type");return o=="pacontainer";})[0];h=m;}g={handler:d,data:{maple:{module:h,ba:{_action:"show",chrome:(g.chrome?"true":"false"),_txnid:e++,_mode:"json",_id:h,modId:n,_container:(g.chrome?1:0),view:"default"}}}};break;}default:g={handler:c,data:{maple:{module:n,ba:{_action:"show",_subAction:g.view=="default"?undefined:g.view,view:g.view,_txnid:e++,_mode:"json",_id:n,_container:(g.chrome?1:0),chrome:(g.chrome?"true":"false")}}}};break;}delete g.moduleId;delete g.type;return g;});f.setRequestFormatter("module",function(g,h){var i=g.moduleId;if(!i){i=h;}return{handler:c,data:{maple:{module:i,ba:b.merge({_txnid:e++,_mode:"json",_id:i,_container:0},g.args)}}};});});},"1.0",{requires:["transport"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("module_api",function(a){a.ModuleApi=function(d,i){var h=i.props,f=a.Lang.isUndefined,b=h.id,j=i.prefs||{},g=null,c=["broadcast","listen","unlisten","closeView","getViewNode","getViewDirection","isViewOpen","navigate","openView","refreshView","setView"],e={getContextData:function(k){var m=i.data,l;if(m){l=(k?m[k]:m);}return(f(l)?g:l);},getId:function(){return b;},getProperty:function(k){var l=h[k];return f(l)?g:l;},getString:function(k){return d.getString(h.type,k);},getPref:function(k){var l=j[k];return f(l)?g:l;},setPref:function(k,l){var m=d.getService("transport");j[k]=l;if(m){m.makeRequest({type:"setpref",prefName:k,prefValue:l,moduleId:b},g,b);return true;}else{return false;}},getService:function(k){return d.getService(k,b);},error:function(k,l){d.error("module",k,a.merge((l?l:{}),{moduleId:b}));},abortRequest:function(k){var l=d.getService("transport");return !!(l&&l.abortRequest(k,b));},isRequestPending:function(k){var l=d.getService("transport");return !!(l&&l.isRequestPending(k,b));},makeRequest:function(k,m){var l=d.getService("transport");return(l?l.makeRequest(k,m,b):-1);}};a.Array.each(c,function(k){e[k]=function(){var l=a.Array(arguments,0,true);l.unshift(b);return d[k].apply(d,l);};});return e;};},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("yui_service",function(d){var b=d.ModulePlatform,a="MPServices",c="YUIProvider";if(d.Plugin&&d.Plugin.NodeFX){d.Node.plug(d.Plugin.NodeFX);}d.namespace(a);d[a][c]={name:"yui",getService:function(e,f){return d;}};if(b){b.registerService(d[a][c]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("metro_viewtype",function(d){var c=null,b=false,a=true;d.namespace("Metro");d.Metro.createViewType=function(l,f){function k(p,o){return f.signal(p,o,[l]);}function j(o){return(o=="fp"||o=="toolbar")?d.one("body"):d.one("#"+l+"-"+o+"-bd");}function e(p){var o=j(p);return o?o.getStyle("direction"):c;}function i(q,p){var o=q.targetId,r=p?p.callback:c;this.setView(o,q.html);if(d.Lang.isFunction(r)){r(o,l);}}function n(o){return j(o)!=c;}function m(p,o,s,q){p=d.Array(p);var r=[];d.Array.each(p,function(t){r.push({type:"loadview",view:l,moduleId:t,chrome:o,data:q});});return f.getService("transport").makeRequest(r,s);}function h(p,r){var q=[],o=a;p=d.Array(p);if(p.length){d.Array.each(p,function(s){if(n(s)){var t=k(s,"viewrefresh");if(t){q.push(s);}}else{o=o&&b;}});if(o){this.loadView(q,false,{success:d.bind(i,this)},r);}}else{o=b;}return o;}function g(p,o){if(n(p)){k(p,"viewunload");j(p).set("innerHTML",o);this._afterSetView(p,o);k(p,"viewload");return a;}else{return b;}}return d.merge(d.ModulePlatform.BaseViewType,{_afterSetView:function(){},getViewDirection:e,getViewNode:j,isViewOpen:n,loadView:m,refreshView:h,setView:g});};},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("default_viewtype",function(c){var m=c.ModulePlatform,h=null,j=false,g=true,k=c.Lang,o=c.DOM,b=j,i={},l={},d={},e,n="default",a="MPViewTypes",f="DefaultViewTypeProvider";c.on("unload",function(){b=g;},window);c.namespace(a);c[a][f]={name:n,create:function(r){function u(B,C,E){var G=r.getModuleApi(B),A=G.getProperty("detailUrl"),F,K,z,D,I,H=j,J=r.queryModules(function(N){var M=r.getModuleApi(N),L=M&&M.getProperty("type");return L=="pacontainer";})[0];switch(C){case"badcrumb":E=r.getProperty("crumbErrorHtml");H=g;break;case"nocookies":E=r.getProperty("cookieErrorHtml");break;default:if(!E){E=c.Lang.substitute(r.getProperty("modErrorHtml"),{message:r.getString("fp","STR.MODULE.ERROR_FALLBACK_TEXT"),name:G.getProperty("title"),img:G.getProperty("icon"),title:G.getProperty("title"),url:G.getProperty("detailUrl")});}}F=E.indexOf('id="default-'+B+'"')>-1?E:c.Lang.substitute(r.getProperty("modChromeHtml"),{html:E,type_name:G.getProperty("type"),view_name:"error"});K=E.indexOf('id="default-'+J+'"')>-1?F:c.Lang.substitute(r.getString("pa","pacontainerHtml"),{html:F,title:G.getProperty("title")});z=o.create(K);if(!A){o.addClass(z,"no-link");}if(H){D=o.create('<p class="oops"><a href="'+window.location.href+'" class="cta-btn">'+r.getString("pa","STR.OK")+"</a></p>");}else{if(e!=B){D=o.create('<p class="oops"><button class="cta-btn pa-mod-err-retry">'+r.getString("pa","STR.TRY_AGAIN")+"</button></p>");}}if(D){I=c.Selector.query(".oops-msg",z,g);if(I){I.appendChild(D);}}e=B;return z;}function v(A,z){if(k.isFunction(A)){A(z,n);}}function p(A){var z=r.getService("pa");return !!(z&&z.isPAModule(A));}function x(A,z){return r.signal(A,z,[n]);}function t(B){if(p(B)){var z=r.getModuleApi(B),C=z.getProperty("type"),A=r.getString("pa","STR.PA.DISCLAIMER"),D;if(A&&!z.getProperty("trusted")&&C!="yap"){D=c.one("#default-"+B+"-ft");if(D){D.set("innerHTML",A);}}}}function q(D,A){var C=r.getService("pa"),E=C.getPacontainerId(),B=r.getService("metrics"),z;if(B){B.start("rv",{moduleId:D});}z=o.create(A);if(z&&!z.length){if(!r.isStarted(E)){r.start(E);}C.setChild(z,D);t(D);C.setModuleLoading(j);x(E,"viewload");i[D]=z;}else{r.error("loadview","Invalid HTML received",{moduleId:D});}if(B){B.stop("rv");}}function w(B,C,z){var A=r.getService("pa"),D=A.getPacontainerId();if(!r.isStarted(D)){r.start(D);}A.setChild(u(B,C,z),B,C);A.setModuleLoading(j);x(D,"viewload");}function y(E,B){var C=E.targetId,A=l[C],H=B?B.callback:h,G=r.getService("metrics"),D=r.getService("transport"),F=E.html,z;if(G){z=D.getMetrics(A);if(z){if("rt" in z){G.set("rt",z.rt);}if("pr" in z){G.set("pr",z.pr);}if("dt" in z){G.set("js",z.dt);}}D.clearMetrics();G.stop("ov");}q(C,F);delete l[C];delete d[C];v(H,C);}function s(C,B){if(!b){var A=C.targetId,D=B?B.callback:h,z;d[A]=1;delete l[A];if(C.result!="abort"){z=r.getService("metrics");if(z){z.clear("ov");}r.error("loadview","Server error while loading default view.",{moduleId:A,html:(C?C.html:""),viewName:n});w(A,C.resultDetail,C.html);v(D,A);}}}return c.merge(c.Metro.createViewType(n,r),{closeView:function(B,D){var A=r.getService("pa"),C=A&&A.getPacontainerId(),z=(A&&p(B))?C:B;if(this.isViewOpen(B)&&x(z,"viewclose")){x(z,"viewunload");if(z==C){delete i[B];A.clearChild(B);}v(D,B);return g;}else{if(k.isNumber(l[B])){r.getService("transport").abortRequest(l[B]);delete l[B];}}return j;},hideView:function(z){if(this.isViewOpen(z)){this.getViewNode(z).get("parentNode").setStyle("display","none");return g;}return j;},openView:function(B,D){var A=r.getService("pa"),C=A&&A.getPacontainerId(),z;if(A&&p(B)&&!this.isViewOpen(B)&&x(C,"viewopen")){z=r.getService("metrics");if(z){z.start("ov",{moduleId:B});}l[B]=this.loadView(B,g,{success:y,failure:s,argument:{moduleId:B,callback:D}});return l[B]!=-1;}else{return j;}},showView:function(z){if(this.isViewOpen(z)){this.getViewNode(z).get("parentNode").setStyle("display","");return g;}return j;},_afterSetView:function(A,z){t(A);}});}};if(m){m.registerViewType(c[a][f]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("edit_viewtype",function(c){var o=null,l=false,h=true,j=c.ModulePlatform,r=o,f=l,q,d=o,e={},g="viewload",n="edit",i="MPViewTypes",a="EditViewTypeProvider";function m(t,s){return r.signal(t,s,[n]);}function b(u,t){var s=u.targetId,v=t?t.callback:o;delete e[s];f=l;d=c.DOM.create(u.html);if(d&&!d.length){r.hideView(s,"default");r.getViewNode(s,"default").get("parentNode").insert(d,"after");m(s,g);if(c.Lang.isFunction(v)){v(s,n);}}else{r.error("loadview","Invalid HTML received",{moduleId:s});}}function p(t){var s=r.getModuleApi(t);return c.Lang.substitute(r.getProperty("modErrorHtml"),{message:r.getString("fp","STR.MODULE.ERROR_FALLBACK_TEXT"),name:s.getProperty("title"),img:s.getProperty("icon"),title:s.getProperty("title"),url:s.getProperty("detailUrl")});}function k(v,u){var t=v.targetId,w=u?u.callback:o,s=p(t);r.getViewNode(t,"default").set("innerHTML",s);r.error("loadview","Server error while loading edit view.",{moduleId:t,html:(v?v.html:""),viewName:n});delete e[t];if(c.Lang.isFunction(w)){w(t,n);}}q={closeView:function(s,u){if(this.isViewOpen(s)){var t=c.one("#edit-"+s).getDOMNode();t.parentNode.removeChild(t);r.showView(s,"default");if(c.Lang.isFunction(u)){u(s,n);}return h;}else{if(c.Lang.isValue(e[s])){r.getService("transport").abortRequest(e[s]);delete e[s];}else{return l;}}},getViewNode:function(s){return c.Node.one("#edit-"+s+"-bd");},isViewOpen:function(s){return this.getViewNode(s)!=o;},loadView:function(s,t){f=h;return r.getService("transport").makeRequest({type:"loadview",view:"edit",moduleId:s,chrome:true},t);},openView:function(s,t){if(!this.isViewOpen(s)&&!f){e[s]=this.loadView(s,{success:b,failure:k,argument:{moduleId:s,callback:t}});return e[s]!=-1;}else{return l;}},refreshView:function(s){return l;},setView:function(t,s){if(this.isViewOpen(t)){m(t,"viewunload");this.getViewNode(t).set("innerHTML",s);m(t,g);return h;}else{return l;}},showView:function(s){return l;}};c.namespace(i);c[i][a]={name:n,create:function(s){r=s;return q;}};if(j){j.registerViewType(c[i][a]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
if(typeof YAHOO=="undefined"){YAHOO={};}if(!YAHOO.ULT){YAHOO.ULT={};}if(!YAHOO.ULT.BEACON){YAHOO.ULT.BEACON="http://geo.yahoo.com/t";}if(!YAHOO.ULT.IMG){YAHOO.ULT.IMG=new Image();}YAHOO.ULT.SRC_SPACEID_KEY="_S";YAHOO.ULT.DEST_SPACEID_KEY="_s";YAHOO.ULT.YLC_LIBSRC=2;YAHOO.ULT.CTRL_C="\x03";YAHOO.ULT.CTRL_D="\x04";YAHOO.ULT.BASE64_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-";(function(){YAHOO.ULT.track_click=function(c,g){if(!c||!g){return c;}g._r=YAHOO.ULT.YLC_LIBSRC;var h=[];var d=0;for(var b in g){var a=g[b];if(typeof(a)=="undefined"){a=g[b]="";}if(b.length<1){return c;}if(b.length>8){return c;}if(b.indexOf(" ")!=-1){return c;}if(YAHOO.ULT.has_ctrl_char(b)||YAHOO.ULT.has_ctrl_char(a)){return c;}h[d++]=b;}h=h.sort();var e=[];for(d=0;d<h.length;d++){e[d]=h[d]+YAHOO.ULT.CTRL_C+g[h[d]];}e=e.join(YAHOO.ULT.CTRL_D);if(e.length<1||e.length>1024){return c;}e=";_ylc="+YAHOO.ULT.encode64(e);d=c.indexOf("/*");if(d==-1){d=c.indexOf("/?");}if(d==-1){d=c.indexOf("?");}if(d==-1){return c+e;}else{return c.substr(0,d)+e+c.substr(d);}};YAHOO.ULT.beacon_click=function(c,b){if(!b){b=YAHOO.ULT.IMG;}if(c){var a=YAHOO.ULT.track_click(YAHOO.ULT.BEACON,c);a+="?t="+Math.random();b.src=a;}return true;};YAHOO.ULT.has_ctrl_char=function(b){for(var a=0;a<b.length;a++){if(b.charCodeAt(a)<32){return true;}}return false;};YAHOO.ULT.encode64=function(c){var a="";var k,h,f="";var j,g,e,d="";var b=0;do{k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64;}else{if(isNaN(f)){d=64;}}a=a+YAHOO.ULT.BASE64_STR.charAt(j)+YAHOO.ULT.BASE64_STR.charAt(g)+YAHOO.ULT.BASE64_STR.charAt(e)+YAHOO.ULT.BASE64_STR.charAt(d);k=h=f="";j=g=e=d="";}while(b<c.length);return a;};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("instrumentation",function(d){var J=null,V=false,I=true,b=d.ModulePlatform,a=J,W=J,X=J,s=J,F=J,G=V,q=J,O=J,n=V,f=V,E=I,k=V,l=V,H=J,e={},r,S,t=J,h="getProperty",A="data-b",Q="aria-disabled",U="data-ylk",i="data-action",z="data-action-outcome",K="MPServices",T="InstrumentationProvider";function o(ab){var Y=new Image();Y.id=d.guid();e[Y.id]=Y;Y.onload=Y.onerror=function(){delete e[this.id];};if(ab){Y.src=ab;}return Y;}function y(ad){var ab=ad.hasAttribute(A)?ad:ad.ancestor(function(ae){return ae.hasAttribute(A);}),Y=ad.getAttribute(Q)=="true",ac=ab?ab.getAttribute(Q)=="true":V;if(ab&&!ad.hasClass("nobeacon")&&!Y&&!ac){return ab.getAttribute(A);}else{return J;}}function v(Y){var ab,ac=a[h]("ywa.rapid.enabled.modules")||{};if(O&&d.Lang.isFunction(t.refreshModule)&&ac[Y.get("id")]){ab=d.one(Y);if(ab){t.refreshModule(ab.generateID());}}}function u(Y){var ab;if(O){if(n&&d.Lang.isFunction(t.refreshModuleAsRichView)){ab=d.one(Y);if(ab){t.refreshModuleAsRichView(ab.generateID());}}else{v(Y);}}}function c(Y){if(O){t.addModules(Y);}}function Z(Y,ac){if(O&&d.Lang.isFunction(t.addModules)){var ad=d.one(Y),ae,ab={};if(ad){ae=ad.generateID();ab[ae]=ac;t.addModules(ab);}}}function L(Y){if(O){if(n&&d.Lang.isFunction(t.addModulesAsRichView)){t.addModulesAsRichView(Y);}else{c(Y);}}}function D(Y){if(O&&d.Lang.isFunction(t.isModuleTracked)){var ab=d.one(Y);if(ab){return t.isModuleTracked(ab.generateID());}}}function C(Y){if(O&&d.Lang.isFunction(t.removeModule)){var ab=d.one(Y);if(ab){return t.removeModule(ab.generateID());}}}function x(ab){if(!ab||!ab.hasAttribute(U)){return J;}var ac={},ad=ab.getAttribute(U),Y;if(ad){Y=ad.split(";");d.Array.each(Y,function(ae){var af=ae.split(":");if(af[0]&&af[1]){ac[af[0]]=af[1];}});if(ab.hasAttribute(i)){ac.action=ab.getAttribute(i);}if(ab.hasAttribute(z)){ac.outcm=ab.getAttribute(z);}}return ac;}function m(ac,Y){var ab=o(),ad;if(!E&&!f){return;}if(ac instanceof d.Node){ac=y(ac);}if(!ac){return;}if(d.Lang.isObject(ac)){ad=d.merge({_S:W,test:X},ac);delete ad.action;delete ad.outcome;if(Y){YAHOO.ULT.BEACON=YAHOO.ULT.BEACON+";"+Y;}YAHOO.ULT.beacon_click(ad,ab);if(Y){YAHOO.ULT.BEACON=F;}}else{if(Y){ac+=";"+Y;}ab.src=(s||YAHOO.ULT.BEACON)+";"+ac+"?t="+(new Date()).getTime();}}function N(Y){if(!O){return;}if(!t){return;}var ab;if(Y instanceof d.Node){ab=x(Y);}else{if(d.Lang.isObject(Y)){ab=Y;}}if(!d.Lang.isObject(ab)||!ab.action){return;}if(ab.action==="click"){t.beaconClick(ab.sec,ab.slk||"",ab.pos||0,ab,ab.outcome||ab.outcm||J);}else{t.beaconEvent(ab.action,ab,ab.outcome||ab.outcm||J);}}function B(ab,Y){m(ab,Y);N(ab);}function R(){var ab=window.location,Y;if(!d.Lang.isUndefined(window._comscore)){Y=o();Y.src=(ab.protocol==="https:"?"https://sb":"http://b")+".scorecardresearch.com/p?c1=2&c2=7241469&c4="+encodeURIComponent(ab.protocol+"//"+ab.host)+"&c5="+W+"&ns_c=UTF-8&ns__t="+(new Date().getTime());}else{if(YAHOO.i13n&&d.Lang.isFunction(YAHOO.i13n.sendComscoreEvent)){YAHOO.i13n.sendComscoreEvent({c7:ab.href});}}}function w(ac){if(G){return;}var ab=a.getProperty("ylp"),Y=o();if(!ab){return;}if(!ac){return;}Y.src=(s||YAHOO.ULT.BEACON)+";"+ab+"?t="+(new Date()).getTime()+"&"+ac;G=true;}function M(){var af,ae=d.Object.getValue(window,["performance","timing"]),ac=a[h]("tsrc"),ab=a[h]("err404"),Y=a[h]("errurl"),ad={pt:1,mrkt:a[h]("intl"),authfb:a[h]("fbauthstate"),f:a[h]("hps")};if(ab){ad.err=ab;}if(Y){ad.err_url=Y;}if(ac){ad.tsrc=ac;}if(ae){af=ae.requestStart;ad.prfm1=ae.responseStart-af;ad.prfm2=ae.responseEnd-af;ad.prfm3=ae.domContentLoadedEventEnd-af;ad.prfm4=+(new Date())-af;}return ad;}function j(ab){if(q){return;}var Y=y(ab);if(Y){q=Y;}else{}}function p(){q=J;}function P(){return(q!==J);}function aa(){if(q){B(q);q=J;}}function g(){var Y=a[h]("addthis.beacon");if(Y){o(Y);}}r={fireBeacon:B,fireUltBeacon:m,fireYwaBeacon:N,getBeaconImage:o};S={collectData:j,fireBeacon:B,fireUltBeacon:m,fireYwaBeacon:N,getBeaconImage:o,fireComscoreBeacon:R,firePageParameterBeacon:w,clearPendingBeacons:p,firePendingBeacons:aa,hasPendingBeacons:P,getBeaconKeys:x,addModules:c,addModule:Z,removeModule:C,isModuleTracked:D,addModulesAsRichView:L,refreshModule:v,refreshModuleAsRichView:u};d.namespace(K);d[K][T]={name:"instrumentation",getService:function(af,ae){if(!a){var ad,ab,ac,Y;a=af;W=a[h]("ultSpaceId");X=a[h]("ywa.rapid.bucket.id");s=a[h]("ultBeaconHost");O=!!a[h]("ywa.rapid.enabled");n=!!a[h]("ywa.rapid.richview.enabled");f=!!a[h]("ywa.rapid.ult.enabled");l=!!a[h]("rapid.init.beacon");k=!!a[h]("ywa.pageview.on.init");H=a[h]("custom.beacon.endpoint");if(YAHOO&&YAHOO.i13n&&H){YAHOO.i13n.beacon_server=H;}if(O){if(typeof YMedia!=="undefined"&&typeof YMedia.rapid!=="undefined"){t=YMedia.rapid;E=V;}else{YAHOO.i13n.YWA_CF_MAP={authfb:11,mrkt:12,pt:13,sec:18,slk:19,cpos:21,pkgt:22,ct:23,bpos:24,cat:25,dcl:26,rescode:27,sort:28,ilc:39,f:40,prfm1:41,prfm2:43,prfm3:44,prfm4:45,ft:51,v:52,sca:53,camp:54,code:55,elm:56,elmt:57,ad:58,tsrc:69,err:72,rspns:107,dir:108,grpt:109,mpos:110,itc:111,sp:115,tar:113,t1:121,t2:122,t3:123,t4:124,t5:125};YAHOO.i13n.YWA_ACTION_MAP={click:12,scrollup:15,hover:17,secview:18,hswipe:19,share:23,reauthfb:24,insert:28,flw:52,unflw:53,rpl:54,rt:55,fav:56,error:99,swp:103,drag:105,hvr:115,secvw:116};YAHOO.i13n.YWA_OUTCOME_MAP={share:23,navigate:25,top:26,hpset:27,open:29,fetch:30,end:31,rmct:32,login:33,close:34,filter:35,connect:36,itemdecl:37,setlayout:38,sort:39,entitydecl:40,undo:41,cueswipeview:42,cueauthview:43,cueloadview:44,cueinfoview:45,cueconnectview:46,msgview:47,authview:48,loadview:49,cuehpset:50,cuedcl:61,dclent:101,dclitm:102,svct:109,unsvct:110,rmsvct:117,slct:121,lgn:125,lgo:126,cnct:127,flagitm:129,unflagitm:130,flagcat:131,unflagcat:132,slctfltr:133,srch:134};E=!f;ad={client_only:!!a[h]("rapid.clientonly"),use_rapid:f,use_sampling:!!a[h]("ywa.rapid.sampling.enabled"),debug:!!a[h]("ywa.rapid.debug"),sampling_affects_ywa:!!a[h]("ywa.rapid.sampling.enabled"),sampling_range:a[h]("ywa.rapid.sampling.range"),spaceid:a[h]("ywa.rapid.space.id"),test_id:X,pageview_on_init:k,track_right_click:!!a[h]("rapid.right.click"),apv:!!a[h]("rapid.add.pageview"),yql_host:a[h]("ywa.rapid.yql.host"),tracked_mods:a[h]("ywa.rapid.enabled.modules"),ywa:{project_id:a[h]("ywa.rapid.project.id"),host:a[h]("ywa.rapid.host")},keys:M(),nofollow_class:["rapidnofollow","video-inline"],webworker_file:a[h]("ywa.rapid.worker.path")};if(typeof YAHOO.i13n.Rapid!=="undefined"){if(l){Y=d.one("body");ab="//geo.yahoo.com/p?s="+a[h]("ywa.rapid.space.id")+"&test=scooby_qa_d&btype=rapidb&t="+Math.random();ac=d.Node.create('<img class="D-n" src='+ab+"/>");Y.append(ac);}t=new YAHOO.i13n.Rapid(ad);}else{t=new YAHOO.i13n.Track(ad);t.init();}}}if(s){YAHOO.ULT.BEACON=s;}F=YAHOO.ULT.BEACON;g();}return(!ae||a.getModuleApi(ae)[h]("trusted")?S:r);}};if(b){b.registerService(d[K][T]);}});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("userinfo_service",function(g){var d=null,c=g.ModulePlatform,a=d,f,b="MPServices",e="UserInfoProvider";f={getDisplayName:function(){return a.getProperty("user");},isLoggedIn:function(){return !!a.getProperty("user");},isRecognized:function(){return !!a.getProperty("userRecognized");},getLocation:function(){var i={},l=a.getProperty("userLocation"),j=["zip","city","state","country","woeid","lat","lon"],h=j.length,k;if(l){while((k=j[--h])){i[k]=l[k]||null;}}return i;}};g.namespace(b);g[b][e]={name:"userinfo",getService:function(i,h){if(!a){a=i;}return f;}};if(c){c.registerService(g[b][e]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("statemgr_service",function(b){var k=b.ModulePlatform,g="MPServices",m="StateMgrProvider",j="MSC",i="fpps",e="fpms",p="_page",l,h,c,d,r,o;function f(){var t=new Date();t.setFullYear(t.getFullYear()+1);return t;}function s(x,v,u){var w=h.getSub(x,v),t=null;if(w){t=c.parse(w)[u];}return t;}function a(z,w,t){var y=h.getSub(z,w),x,v,u;if(y){x=c.parse(y);delete x[t];v=c.stringify(x);u={expires:f(),domain:l,path:"/"};if(v=="{}"){h.removeSub(z,w,u);}else{h.setSub(z,w,v,u);}}}function q(y,u,t,w){var x=h.getSub(y,u),v=x?b.JSON.parse(x):{};v[t]=w;h.setSub(y,u,c.stringify(v),{expires:f(),domain:l,path:"/"});}function n(t){if(!d[t]){d[t]=r.getModuleApi(t).getProperty("trusted")?b.Object(o):{};b.mix(d[t],{getUserModuleState:function(u){return s(e,t,u);},removeUserModuleState:function(u){a(e,t,u);},setUserModuleState:function(u,v){q(e,t,u,v);},saveUserSetting:function(w,x,u){var v=k.getService("userinfo");if(v.isLoggedIn()){u.makeRequest({type:"module",moduleId:u.getId(),args:{_action:"save",_subAction:"userPrefSave",key:w,value:x,noups:1}},{});}else{this.setUserModuleState(w,x);this.update();}}});}return d[t];}o={isUpdated:function(){return !!h.get(j);},update:function(){h.setSub(j,"mod","1",{domain:l,path:"/"});},getUserPageState:function(t){return s(i,p,t);},removeUserPageState:function(t){a(i,p,t);},setUserPageState:function(t,u){q(i,p,t,u);}};b.namespace(g);b[g][m]={name:"statemgr",getService:function(u,t){r=u;h=b.Cookie;c=b.JSON;l=u.getProperty("cookieDomain")||b.config.win.location.hostname;if(!d){d={};}return !t?o:n(t);},destroy:function(){d=null;}};if(k){k.registerService(b[g][m]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("arcade_transport",function(f){var M=null,ag=false,H=true,S,d=f.ModulePlatform,c=M,ah,i=encodeURIComponent,n=f.Lang,l=f.Object,w=f.Array,N,G,D,e,ab=ag,P={},ad={},ai=[],x,g=ag,u,o,X=0,aj=1,s=2,v=3,C=2048,af=131072,p="_status",Z="_txnid",U="POST",B="GET",h="getProperty",R="MPServices",ac="TransportProvider";function K(L,A){c.error("transport",L,A);}function W(O){var L=M,A;switch(O.type){case"moduleload":L={_action:"show",_create:1,_suid:O.contentId};break;case"setpref":L={_action:"save",_subAction:S,_type:"pref",modid:O.moduleId,_create:1};break;case"loadview":if(O.view=="pa"){A=c.queryModules(function(ak){var Y=c.getModuleApi(ak);return Y&&Y.getProperty("type")=="pa";})[0];L={_action:"show",_subAction:"single",modId:O.moduleId,_container:0,_id:A};}else{L={_action:"show",_subAction:O.view=="default"?S:O.view,_id:O.moduleId,_container:O.chrome?1:0};}break;case"arcade":case"module":L=O.args;L._container=O.chrome?1:0;L._id=O.moduleId;break;default:K("Request doesn't have a type.");break;}O=L?f.merge(L,O):f.mix({},O);delete O.type;delete O.moduleId;delete O.args;return O;}function J(L){var A=L.match(/^((?:\w+:\/\/)?[^#?]+)/);return(A&&n.isArray(A))?A[1]:"";}function aa(L){if(!L){return"";}var A=[];l.each(L,function(Y,O){if(n.isValue(Y)){if(!n.isString(Y)){Y=f.JSON.stringify(Y);}A.push(O+"="+i(Y));}});return A.join("&");}function E(O,am,al){if(!al){K("Proxy request: No module id given, unable to look up proxy signature.");}var ak=J(O.url),Y=c.getModuleState(al).proxy[ak],L,A;if(!Y){K("Proxy request: '"+O.url+"' has not been registered for proxying.");}L=G+"?url="+i(O.url)+"&.sig="+Y+"&.crumb="+N;A={method:O.method,data:O.bodyData,on:am,headers:O.headers};return f.io(L,A);}function b(al,aq,L){if(al.type=="xhr"){return E(al,aq,L).id;}D=D?D:"/jsal";var A=D,an={method:B,on:x},ak={_crumb:N,_mode:"json"},am=c[h]("passthru"),ap,ao,Y,O;if(n.isArray(al)){an.method=U;}else{al=[al];}if(e){ak.pgmode=e;ak.reqSource=e;}ak[Z]=new Date().getTime();w.each(al,function(at,ar){al[ar]=W(at);al[ar][Z]=ak[Z];});if(an.method==B){ap=f.merge(al[0],ak);ao=aa(ap);if(ao.length>2000){an.method=U;}else{A=D+"?"+ao;}}if(am){A+=(A.indexOf("?")>-1?"&":"?")+am;}if(an.method==U){an.data=aa(ak)+"&_json="+i(f.JSON.stringify(al));}Y=f.io(A,an);O=Y.id;P[O]={args:arguments,moduleId:L,conn:Y};if(aq){P[O].callback=aq;}return O;}function m(){if(n.isArray(o)){while(o.length>0){var A=o.shift();b.apply(this,A);}u.detach();u=o=M;}g=ag;}function j(A){g=H;if(A){o=[];u=f.on("unload",f.bind(m,this,H),window);}}function z(ak,Y,O){var L=Y.responseText,A;if(L){A=L.indexOf("<!--");if(A>0){L=L.substring(0,A);}}N=L;m();ab=ag;}function T(O,L,A){K("Unable to update crumb.");}function F(){if(ab){return ag;}ab=H;j(H);var A={success:z,failure:T,scope:this};f.io("/?_mode=html&_action=show&_type=pref&_create=1&_subAction=_cFetch",{method:B,on:A});}function r(O,Y,L){if(g){if(n.isArray(o)){var A=f.Array(arguments);o.push(A);return M;}return ag;}return b(O,Y,L);}function a(L){var A=(P[L]&&P[L].conn&&P[L].conn.isInProgress());return A;}function V(A){if(a(A)){P[A].conn.abort();}else{return false;}}function t(A){if(A&&P[A]&&P[A].args){r.apply(M,P[A].args);delete P[A];delete ad[A];return H;}return ag;}function k(ak,O,A){if(n.isUndefined(O)){O=H;}if(n.isFunction(ak)){ak(ak.argument,A);}else{var L=ak.scope||ak,Y=O?ak.success:ak.failure;if(Y){Y.call(L,A,ak.argument);}}}function y(Y,A,L){var O=P[Y].callback;if(O){k(O,L,A);}if(!n.isUndefined(ad[Y])){if(ad[Y]>1){ad[Y]-=1;}else{delete ad[Y];}}if(n.isUndefined(ad[Y])){delete P[Y];}}function Q(al,A){var L=A._errorCode,Y=A._error,ak=P[al].callback,O={message:Y,moduleId:P[al].moduleId};if(A[p]==aj){if(L==af){if(!ab){F();}t(al);}else{K(Y,O);if(O.moduleId){return;}}}if(ak){k(ak,ag,O);}}function ae(){var A=ai.shift(),O,L;if(A){O=A[Z];if(A[p]!=X){Q(O,A);}else{L=c.getService("resourcemgr");if(A.props&&A.props.id){c.registerModule(A);}if(A.res){L.load(A.res,f.bind(y,M,O,A));}else{y(O,A);}}if(ai.length){n.later(1,this,ae);}}}function I(O,L,A){setTimeout(function(){y(O,L,ag);},0);}function q(ak,Y,A){var O;try{O=f.JSON.parse(Y.responseText);}catch(L){}finally{if(!n.isArray(O)){I(ak,Y,A);return;}}w.each(O,function(am){if(am[p]!=X){Q(ak,am);return;}var al;if(am.response){al=am.response;}else{al=[am];}if(!ad[ak]){ad[ak]=0;}ad[ak]+=al.length;w.each(al,function(an,ao){an._partId=ao;an[Z]=ak;if(!an.data){an.data={};}an.data=f.merge(am.data,an.data);});ai=ai.concat(al);});if(ai.length){n.later(1,this,ae);}}ah={E_OK:X,E_FATAL:aj,E_GLOBAL:s,E_MODULE:v,EC_CRUMB_ERR:C,EC_CRUMB_STALE:af,disable:j,enable:m,isEnabled:function(){return !g;},makeRequest:r,abortRequest:V,isRequestPending:a,_reset:function(){ab=ag;P={};ad={};ai=[];o=M;m();}};x={success:q,failure:I,scope:this};f.namespace(R);f[R][ac]={name:"arcade_transport",getService:function(L,A){if(!c){c=L;N=c[h]("crumb");if(n.isUndefined(N)){N=c[h]("dali").crumb;}G=c[h]("proxyUrl");D=c[h]("requestUrlLite");e=c[h]("pgmode");}return A?M:ah;}};if(d){d.registerService(f[R][ac]);}},"1.0",{requires:["event","io"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("tooltip_service",function(b){var m=b.ModulePlatform,n,d,e="MPServices",a="ToolTipProvider",i="hide",l="bottom",f="top",h=null,c="left",j="right",g="px";function k(p){var o;this.options=b.merge({position:{box:"b",arrow:"c"},msg:"<!-- empty -->",className:"y-tooltip-default",pointerClass:"y-glbl-universal",borderClass:"",parentNode:document.body,autohide:false,role:"alert",scrollIntoView:false},p);this.options.parentNode=b.one(this.options.parentNode);if(b.Lang.isArray(this.options.borderClass)){this.options.borderClass=this.options.borderClass.join(" ");}if(b.Lang.isArray(this.options.className)){this.options.className=this.options.className.join(" ");}if(b.Lang.isArray(this.options.pointerClass)){this.options.pointerClass=this.options.pointerClass.join(" ");}o="<div class='y-tooltip "+this.options.className+"'><div class='tooltip hide' role='"+this.options.role+"'><div class='content "+this.options.borderClass+"'></div><span class='"+this.options.pointerClass+" pointer'></span><div class='crnr-rt'></div><div class='crnr-rb'></div></div></div>";this.toolTipBody=b.Node.create(o);this.pointAtMe=h;this.toolTip=this.toolTipBody.one(".tooltip");this.content=this.toolTipBody.one(".content");this.pointer=this.toolTipBody.one(".pointer");this.autohideId=h;this.options.parentNode.insertBefore(this.toolTipBody,this.options.parentNode.get("firstChild"));if(this.options.autohide){this.autohideId=d.getService("autohide").register({targets:[this.toolTip],hide:b.bind(this.hide,this)});}}k.prototype={getNode:function(){return this.toolTipBody;},setContent:function(o){if(typeof(o)==="string"){this.content.set("innerHTML",o);}else{this.content.set("innerHTML","");this.content.appendChild(b.one(o));}return this.content;},positionToolTip:function(s,D){var u,A,z,w,t=D.msg,y=D.position.box,B=D.position.arrow,r=D.position.alignNode,q=this.toolTip,p=this.pointer,v,C,x=D.parentNode.getStyle("direction"),o=D.noMsgUpdate||false;if(x==="rtl"){if(y==="r"){y="l";}else{if(y==="l"){y="r";}}if(B==="l"){B="r";}else{if(B==="r"){B="l";}}}w=this.pointAtMe=b.one(s);if(r){r=b.one(r);}if(!o&&t){this.setContent(t);}u=b.DOM.region(b.Node.getDOMNode(w));A=u.left+(u.width/2);z=u.top+(u.height/2);v=this.toolTip.get("parentNode").get("region");C=this.toolTip.get("region");if(u){switch(y){case"b":q.replaceClass(f,l);break;case"t":q.replaceClass(l,f);break;case"l":q.replaceClass(j,c);break;case"r":q.replaceClass(c,j);break;}switch(B){case"l":p.replaceClass("rightpointer","leftpointer");p.setStyle(c,"");q.setStyle(c,(u.left-v.left)-(this.pointer.getX()-C.left+(this.pointer.get("offsetWidth")/2))+(u.width/2)+g);break;case"c":if(y=="b"||y=="t"){p.setStyle(c,(C.width/2)-(this.pointer.get("offsetHeight")/2)+g);q.setStyle(c,(u.left-(C.width/2)+(u.width/2))-v.left+g);}else{p.setStyle(f,((C.height/2)-(this.pointer.get("offsetHeight")/2))+g);}break;case"r":p.replaceClass("leftpointer","rightpointer");p.setStyle(c,"");q.setStyle(c,((u.right-C.width)-v.left)+g);break;case"t":p.replaceClass("pointerbottom","pointertop");break;case"b":p.replaceClass("pointertop","pointerbottom");break;}switch(y){case"b":q.setStyle(f,(u.top-v.top+u.height+this.pointer.get("offsetHeight"))+g);break;case"t":q.setStyle(f,(u.top-v.top-C.height-this.pointer.get("offsetHeight"))+g);break;case"l":if(r){q.setStyle(f,(r.getY()-v.top)+g);}else{q.setStyle(f,(z-(this.pointer.getY()-C.top)-(this.pointer.get("offsetHeight")/2))-v.top+g);}q.setStyle(c,(u.left-v.left-C.width-this.pointer.get("offsetWidth"))+g);break;case"r":if(r){q.setStyle(f,(r.getY()-v.top)+g);}else{q.setStyle(f,(z-(this.pointer.getY()-C.top)-(this.pointer.get("offsetHeight")/2))-v.top+g);}q.setStyle(c,u.right-v.left+this.pointer.get("offsetWidth")+g);break;}}},show:function(q,o){var p=b.merge(this.options,o);this.toolTip.removeClass(i);if(q){this.positionToolTip(q,p);}this.toolTip.setAttribute("role",p.role);if(p.scrollIntoView){this.content.scrollIntoView();}return this.content;},hide:function(){this.toolTip.addClass(i);},isVisible:function(){return !this.toolTip.hasClass(i);},destroy:function(){if(this.autohideId!==h){d.getService("autohide").unregister(this.autohideId);this.autohideId=h;}this.toolTipBody.get("parentNode").removeChild(this.toolTipBody);this.toolTipBody=this.pointAtMe=this.toolTip=this.content=this.pointer=h;}};n={create:function(o){return new k(o);}};b.namespace(e);b[e][a]={name:"tooltip",getService:function(p,o){if(!d){d=p;}return n;}};if(m){m.registerService(b[e][a]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("metrologger",function(b){var j=b.ModulePlatform,c,k,g="/perf.gif",h,i={},f,d="MPServices",a="MetroLoggerProvider";function e(o,n){var m=new Image(),l="",p=b.merge(o,{rid:c.getProperty("requestId"),bid:c.getProperty("ywa.rapid.bucket.id")||""});m.id=b.guid();i[m.id]=m;m.onload=m.onerror=function(){delete i[this.id];};b.Object.each(p,function(r,q){l+=encodeURIComponent(q)+"="+encodeURIComponent(r)+"&";});m.src=n+"?"+l;return l;}f={logError:function(m,l){e({moduleId:m,msg:l},k);},logPAPerf:function(l){e(l,g);},logAd:function(l){var m=e(l,h);}};b.namespace(d);b[d][a]={name:"metrologger",getService:function(m,l){if(!c){c=m;}if(!k){k=m.getProperty("jsErrorUrl");h=k;}return(!l||m.getModuleApi(l).getProperty("trusted")?f:null);}};if(j){j.registerService(b[d][a]);}});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var b,a,e,d,c;c={getContainer:function(){return b;},setChild:function(f){if(b.hasChildNodes()){b.replaceChild(f,b.get("firstChild"));}else{b.appendChild(f);}}};YModules.type_badge={services:[{name:"badge",getService:function(f,g){return c;}}],init:function(f){this.moduleapi=f;a=f.getService("moduleplatform");e=this.Y=f.getService("yui");d=this.N=e.Node;this.badgeModule=null;b=this.Y.one("#badge-container");a.subscribe("navigate",this.handleNavigate,this,true);a.subscribe("modulestart",this.handleModuleStart,this,true);},onviewload:function(h){var g,f;if(h=="default"){g=this.moduleapi.getContextData();if(g&&g.mods){f=g.mods[0];a.registerModule(f);this.badgeModule=f.props.id;a.start(this.badgeModule,true,true);}}},handleNavigate:function(f){location.href=f.url;},handleModuleStart:function(i){var h=i.moduleId,f=a.getModuleApi(h),k=f.getProperty("type"),g=f.getContextData("mods"),j=this.Y;if(k!="badge"){if(j.Lang.isArray(g)){j.Array.each(g,function(l){a.registerModule(l);a.start(l.props.id,true,true);});}}}};})();/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("transport_helper_service",function(f){var a="MPServices",e="TransportHelperServiceProvider",c="abort",d={},g=null;function b(h,i){this.arcadeTransport=h.getService("arcade_transport");this.moduleapi=h.getModuleApi(i);this.arcadeLiteEnabled=h.getProperty("arcadeLiteEnabled");}b.prototype={makeRequest:function(h,k){var j=f.clone(h||{},true),i=this.arcadeTransport;if(j.ups||j.udb||this.arcadeLiteEnabled==="0"){i=this.moduleapi;if(!j.ups){j.noups=1;}delete j.ups;delete j.udb;}j.args=f.merge(j.args,{prid:g});return{transport:i,id:i.makeRequest(j,k),abort:function(){return this.transport.abortRequest(this.id);}};},wasAborted:function(h){return(h&&(h.result===c||h.statusText===c));}};f[a][e]={name:"transport_helper",getService:function(h,i){if(!g){g=h.getProperty("requestId");}if(!d.hasOwnProperty(i)){d[i]=new b(h,i);}return d[i];}};if(f.ModulePlatform){f.ModulePlatform.registerService(f[a][e]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var ag=null,t=false,M=true,T=ag,b=ag,ar=ag,y,am=ag,ah=1000/60,aQ=2*24*60*60*1000,g=20,aC="click",O="mouseover",S="mouseout",ai="focus",au="blur",aD="ul",s="li",aM="> "+aD+":last-of-type",k="hover",aX="newcontent",I="lastnew",aF="more",av="fetch_uuids",aW="content_by_uuid",ax="stream:click",P="stream:dynamic",Q="stream:filter",C="stream:refresh",j="location:update",N="stream:fallback",L="stream:loadsuccess",d="stream:new_content",U="stream:entities",H="stream:filters",D="y-tooltip-stream",aT=D+"-1",aR=D+"-2",aP=D+"-3",aO=D+"-4",aN=D+"-5",ab="hidden",V="dn",aY="remove",at="label",aS="value",o="disabled",i="checked",B="offsetHeight",aL="offsetWidth",aH="height",G="data-ka",E="data-kb",al=s+".rmx-ad",ak=s+".related-tweet",F=s+".stream-ad,"+al,Z=al+" .adlink",f=al+" .adv",aq=al+" .sp",m=Z+","+f+","+aq,n="data-uuid",ao=s+".content",aA="highline",u="data-reason",z="data-i",aV="data-wikiid",c="data-wikiids",aG="next-batch",ae="."+aG,ad="endfilters",J="."+ad,aw=".historystate",x=">H2,>UL,>.loading,>.type_login,>.strm-error-msg,>.see-more-button",w="li.cavideo h3 a,li.slideshow h3 a",af="hovertitle",ap="YPROP:LOCAL",ac="YPROP:SAVE",v="YCUSTOM:MYTEAMS",aU="fblogin",h="ylogin",aj="streamLoginType",a=0,aJ=".action-drawer-button-wrapper",aB="saved",an="liked",A="disliked",r="flagged",ay="drawer-open",R="p_30345831",aE="pos-feedback",X="neg-feedback",q="hilite",l=ao+"."+q,K="request-manager",W="streamReadList",aa="streamClosedList",aK="streamEntityFeedbackList",p="streamState",az="streamFlaggedList",e="data-impr-beacon",aI="data-rmx-beacon";YModules.type_stream={body:ag,list:ag,lastScrollCheck:0,scrollThrottle:40,scrollBuffer:50,id:"",moduleapi:ag,platform:ag,viewevents:[aC],instrumentation:ag,batchCount:1,pollBatchCount:0,batchSize:0,clientPagination:ag,items:ag,woeId:ag,intl:ag,ccode:ag,filter:ag,itemRemovalTimer:ag,currentRemovalMenu:ag,pendingNewItems:[],swipeMenu:ag,yepService:ag,yepPlayer:ag,evtStreamEntities:ag,isRmp:t,nativeAds:[],locationPickerEnabled:false,locationService:null,locationInstance:null,init:function(a0){T=a0.getService("yui");b=T.config.win;ar=T.config.doc;try{am=!!(b.history&&b.history.replaceState&&b.history.state!==y);}catch(aZ){am=t;}var Y=a0.getContextData();this.moduleapi=a0;this.id=a0.getId();this.platform=a0.getService("moduleplatform");this.transportHelperService=a0.getService("transport_helper");this.listeners=[];this.customEvents=[];this.instrumentation=a0.getService("instrumentation");this.storage=a0.getService("storage");this.statemgr=a0.getService("statemgr");this.saveForLaterService=a0.getService("saveforlater");this.highlineService=a0.getService("stream_highline");this.userinfo=a0.getService("userinfo");this.loginService=a0.getService("login");this.interestsService=a0.getService("interests");this.batchSize=Y.batchSize||20;this.woeId=Y.woeId;this.intl=Y.intl;this.ccode=Y.ccode||"";this.listId=Y.listId||"";this.pageloadListId=Y.pageloadListId||"";this.blogType=Y.blogType||"";this.items=Y.items||[];this.clientPagination=Y.clientPagination;this.filter={category:Y.filter||"",name:Y.catName||""};this.contentpos=Y.contentpos;this.dynamicEnabled=Y.dynamicEnabled;this.removalMenuEnabled=Y.removalMenuEnabled;this.pollForNewBroadcastEnabled=Y.pollForNewBroadcastEnabled;this.pollForNewFrequency=Y.pollForNewFrequency;this.pollForNewAutoInsert=Y.pollForNewAutoInsert;this.pollForNewPauseOnIdle=Y.pollForNewPauseOnIdle;this.userIdleAfter=Y.userIdleAfter;this.newCountInTitleEnabled=Y.newCountInTitleEnabled;this.pendingNewItems=Y.pendingNewItems||[];this.restoreStateExpire=Y.restoreStateExpire;this.restoreStateMethod=Y.restoreStateMethod;this.restoreStateOnCacheMiss=Y.restoreStateOnCacheMiss;this.batchPause=Y.batchPause;this.endFiltersEnabled=Y.endFiltersEnabled;this.endFiltersCount=Y.endFiltersCount;this.activeItemId=Y.contentId;this.highlightActive=Y.highlightActive;this.highlightActiveBroadcastScroll=Y.highlightActiveBroadcastScroll;this.itemClickBroadcastOnly=Y.itemClickBroadcastOnly;this.itemClickContext=Y.itemClickContext;this.markAsReadEnabled=Y.markAsReadEnabled;this.closeEnabled=Y.closeEnabled;this.fbAcctLinked=Y.fbAcctLinked;this.tooltipsEnabled=Y.tooltipsEnabled;this.interestFiltersEnabled=Y.interestFiltersEnabled;this.interestFiltersBroadcast=Y.interestFiltersBroadcast;this.broadcastDynamicEnabled=Y.broadcastDynamicEnabled;this.sortBy=Y.sortBy;this.isRmp=Y.isRmp;this.minArticleCount=Y.minArticleCount;this.saveEnabled=Y.saveEnabled;this.inlineLightboxEnabled=Y.inlineLightboxEnabled;this.actionDrawerEnabled=Y.actionDrawerEnabled;this.actionDrawerButtonsEnabled=Y.actionDrawerButtonsEnabled;this.writeMixerActions=Y.writeMixerActions;this.readMixerActions=Y.readMixerActions;this.inFallbackState=Y.inFallbackState;this.nonPersonalStream=Y.nonPersonalStream;this.registerRapidInViewport=Y.rapidInViewport;this.flagContentEnabled=Y.flagContentEnabled;if(this.interestsService&&Y.interestsData){this.interestsService.set(Y.interestsData);}if(!this.filter.category&&this.pageloadListId&&this.listId!==this.pageloadListId){this.filter.category="LISTID:"+this.listId;}T.Node.DOM_EVENTS.mouseenter=1;T.Node.DOM_EVENTS.mouseleave=1;T.Node.DOM_EVENTS.touchend=1;T.Node.DOM_EVENTS.pageshow=1;a0.listen(Q);a0.listen(P);a0.listen(C);this.platform.subscribe(j,this.handleLocationUpdate,this);T.on("pageshow",function(a1){this.markRead();},b,this);this.initGlobalListeners();},onviewload:function(aZ){if(aZ==="default"){var Y=this.moduleapi;this.body=Y.getViewNode(aZ);this.rapidContainer=this.body.ancestor(".rapid-container")||this.body;this.isLoading=t;this.locationPickerEnabled=Y.getContextData("locationPickerEnabled");this.setupScroll();if(this.restoreStateExpire){this.restoreState(this.initDefaultView);}else{this.initDefaultView();}}},initDefaultView:function(){if(this.storage){this.storage.onReady(this.setupDefaultView,this);}else{this.setupDefaultView();}},setupDefaultView:function(){var a0=this.moduleapi,a1=a0.getContextData("dynamicCategories"),aZ=a0.getContextData("dynamicEntities"),a2=this.activeItemId&&this.getItemByUuid(this.activeItemId);this.markRead();this.markFlag();this.updateDislikedInterests();this.updateControls();if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.cacheNativeAdData();this.initPagination();this.statemgr.removeUserModuleState("context");if(a2){if(this.highlightActive){this.highlightItem(a2);if(!this.restored){if(this.highlightActiveBroadcastScroll){T.Global.fire("media:scroll-into-view",{node:a2});}else{this.scrollDomNode.scrollTop=a2.get("offsetTop")-(this.scrollNodeHeight-a2.get(B))/2;}}}if(this.interestFiltersBroadcast){this.broadcastEntities(a2);}}if(!a0.getContextData("skipCheckBufferOnload")){T.later(0,this,this.checkScroll);}this.platform.on("ready",function(){if(a1&&T.Lang.isArray(a1)&&a1.length>0&&!this.inFallbackState){this.moduleapi.broadcast(P,{dynamicCategories:a1});}if(this.broadcastDynamicEnabled){this.broadcastDynamicFilters({dynamicCategories:a1,dynamicWikis:aZ});}if(this.inFallbackState){this.moduleapi.broadcast(N,{});this.dynamicCats=ag;}this.moduleapi.broadcast(Q,T.merge(this.filter,{norefresh:1}));},this);if(this.pollForNewFrequency&&this.body.one(ao)){if(!this.pollForNewAutoInsert){this.listeners.push(this.body.delegate(aC,this.onClickNewContentNotice,".newcontentnotice button",this));this.listeners.push(T.on("resize",T.bind(this.positionNewContentNotice,this,M)));}if(this.pollForNewPauseOnIdle&&this.userIdleAfter){this.idleService=a0.getService("idle");if(this.idleService){this.idleService.on("idleChange",this.onIdleChange,this);this.idleService.start(this.userIdleAfter);}}this.scheduleNewContentPoll();if(this.pendingNewItems.length){this.onNewContent();}}if(this.saveForLaterService){this.saveForLaterWidget=new this.saveForLaterService({body:this.body,moduleApi:a0,writeToMixer:this.writeMixerActions,itemSelector:ao,saveHandler:T.bind(this.onSaveArticle,this),signedOutSaveHandler:T.bind(this.onSignedOutSaveClick,this)});}if(this.actionDrawerEnabled){this.actionDrawer=a0.getService("stream_action_drawer");if(this.actionDrawer){this.actionDrawer.on("declareFeedback",this.onActionDrawerFeedback,this);this.actionDrawer.on("removeStreamItem",this.removeStreamItem,this);this.actionDrawer.on("onFlagDone",this.onFlagDone,this);this.actionDrawer.on("recordFlag",this.recordFlag,this);this.actionDrawer.on("deleteSaved",this.deleteSavedFromActionDrawer,this);if(!this.actionDrawerButtonsEnabled){this.actionDrawer.on("drawerToggleStart",this.disableStreamButtons,this);this.actionDrawer.on("drawerToggleComplete",this.enableStreamButtons,this);this.actionDrawer.disableButtons();}}}if(a0.getContextData("swipeEnabled")){this.swipeMenu=a0.getService("stream_swipe_menu");this.swipeMenu.init({rootNode:this.body,swipeEducCount:a0.getContextData("swipeEducCount"),swipeEducMaxViews:a0.getContextData("swipeEducMaxViews"),filter:this.filter,closeEnabled:this.closeEnabled,eventHandlers:{onRemoveTransition:T.bind(this.fancyRemove,this),onRemoveContent:T.bind(this.removeContent,this),onSavedRemove:this.saveForLaterService?T.bind(this.deleteSavedArticle,this):ag}});}if(this.tooltipsEnabled){try{this.tooltip=a0.getService("tooltip").create({parentNode:this.body,className:D,position:{box:"t",arrow:"c"}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([O,ai],this.onShowTooltip,".label, .profile-img, .more, .side-button",this));this.listeners.push(this.body.delegate([S,au],this.onHideTooltip,".label, .profile-img, .more, .side-button",this));}catch(Y){}}if(a0.getContextData("playIconHoverEnabled")){this.listeners.push(this.body.delegate([O,S],this.onHoverTitle,w,this));}if(this.removalMenuEnabled){this.listeners.push(this.body.delegate(O,this.onMouseOverMenu,".remove",this));this.listeners.push(this.body.delegate(S,this.onMouseOutMenu,".remove",this));}if(this.interestFiltersEnabled){this.listeners.push(this.body.delegate([O,ai],this.onMouseOverLi,".content",this));this.listeners.push(this.body.delegate([S,au],this.onMouseOutLi,".content",this));}if(T.UA.ie&&T.UA.ie<=6){this.listeners.push(this.body.delegate([O,S],this.onHoverContent,"ul .content",this));}this.pruneClosed();if(this.filter.category===ap&&this.locationPickerEnabled===true){this.initLocation();}T.Global.fire("pane-manager:sync-nav-pane-scroll");},onviewunload:function(Y){if(Y==="default"){this.body=ag;if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ag;}T.Array.each(this.listeners,function(aZ){aZ.detach();});this.listeners=[];T.Array.each(this.customEvents,function(aZ){aZ.fired=t;});this.customEvents=[];if(this.scrollListener){this.scrollListener.detach();this.scrollListener=ag;}if(this.newContentPoll){this.newContentPoll.cancel();this.newContentPoll=ag;}if(this.tooltip){this.tooltip.destroy();this.tooltip=ag;}if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}},onmessage:function(a1,aZ,a0){switch(a1){case Q:if(!a0||!a0.norefresh){this.onFilter(a0);}break;case C:this.onFilter(this.filter);break;case P:this.moduleapi.unlisten(P);this.dynamicCats=a0.dynamicCategories;var Y=this.getNode(J);if(Y){this.handleStreamEnd(Y);}break;default:}},handleLocationUpdate:function(Y){if(this.platform.getProperty("loc.cookie.persistent")&&this.statemgr){this.statemgr.setUserPageState("_fpts",Math.round(new Date().getTime()/1000));}this.woeId=Y.woe;if(this.filter.category===ap){this.onFilter(this.filter);}},onviewevent:function(aZ,Y){if(aZ==="default"){if(Y.type===aC){this.onClick(Y);}else{}}},initLocation:function(aZ){var a1=this.body.one(".loc-picker"),a0=this.moduleapi,Y;if(a1){if(!a1.one(".loc-picker-link")){return false;}if(!this.locationService){this.locationService=a0.getService("location_service");}Y={locDropSettings:{crumb:a0.getContextData("locdrop_crumb"),locale:a0.getContextData("locale"),bestLoc:a0.getContextData("best_loc"),curLoc:a0.getContextData("cur_loc"),defLoc:a0.getContextData("def_loc"),userLoc:this.userCitySelection||a0.getContextData("user_loc"),anchorClass:"",glApi:a0.getContextData("useGlApi")},beacon:{sec:a0.getContextData("beacon_sec"),slk:a0.getContextData("beacon_slk"),test:a0.getContextData("beacon_bucketid")}};if(this.locationInstance&&aZ){this.locationInstance.destroy();this.locationInstance=null;if(this.locationService){this.locationInstance=this.locationService.create(a1,this.id,a0,Y);}}else{if(!this.locationInstance){if(this.locationService){this.locationInstance=this.locationService.create(a1,this.id,a0,Y);}}}}},loadContent:function(aZ,a0,a2){var a1,Y={};if(this.pollRequestObj&&!aZ.poll){this.pollRequestObj.abort();this.pollRequestObj=ag;}if(this.filter.category===ap){Y.ups=M;}else{if(this.filter.category===v){Y.udb=M;}}a2=a2||{};a1=this.transportHelperService.makeRequest(T.merge({type:"module",moduleId:this.id,args:T.merge({_action:"show",batch:this.batchCount+1,cat:this.filter.category||"",catName:this.filter.name||"",sb:this.sortBy,ccode:this.ccode,woeid:this.woeId},aZ)},Y),{success:a2.success||this.loadContentSuccess,failure:a2.failure||this.loadContentFailure,scope:this,argument:T.merge(a0,{subAction:aZ._subAction})});return a1;},loadContentSuccess:function(a4,a2){var a0=this.moduleapi,aZ=this.getNode(a2.insertNode),a3=this.getNode(a2.removeNode),a1,Y;if(a4.html){if(aZ){aZ.insert(a4.html,a2.insertLoc);}this.pruneClosed();this.markRead();this.markFlag();this.instrumentation.refreshModuleAsRichView(this.rapidContainer);}if(a3){a3.remove();}if(a3||aZ){this.cacheNativeAdData();}if(a2.subAction===aF){this.isLoading=t;a1=a0.getContextData("dynamicCategories");if(a1&&T.Lang.isArray(a1)&&a1.length>0&&!this.inFallbackState){if(this.filter&&this.filter.category===""){this.platform.on("ready",function(){a0.broadcast(P,{dynamicCategories:a1});},this);}}Y=a0.getContextData("dynamicEntities");if(a4.hasOwnProperty("data")){if(a4.data.hasOwnProperty("contentpos")){this.contentpos=a4.data.contentpos;}if(a4.data.comscore==="pageview_candidate"){this.instrumentation.fireComscoreBeacon();}if(a4.data.hasOwnProperty("items")&&T.Lang.isArray(a4.data.items)){this.items=this.closeEnabled?this.removeDuplicates(a4.data.items,this.storage.getSet(aa,M)):a4.data.items;}if(this.interestsService&&a4.data.hasOwnProperty("interestsData")){this.interestsService.set(a4.data.interestsData);}}if(a2.firstBatch){if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.ccode=a0.getContextData("ccode");this.clientPagination=a0.getContextData("clientPagination");}}else{if(a2.subAction===aW){this.contentReqDone=M;}}this.batchCount+=1;this.moduleapi.broadcast(L,{category:this.filter.category,batchCount:this.batchCount});this.body.all("a.twitter-follow-button").each(function(a5){b.twttr.widgets.load(a5.getDOMNode());});if(this.filter.category===ap&&this.locationPickerEnabled===true){this.initLocation(true);}T.later(ah,this,function(){this.body.setStyle(aH,ag);var a5=this.getNode(J);if(a5){this.handleStreamEnd(a5);}else{this.checkScroll();}});T.Global.fire("pane-manager:sync-nav-pane-scroll");},loadContentFailure:function(a0,Y){if(this.transportHelperService.wasAborted(a0)){return;}var aZ=this.getNode(Y.removeNode);if(aZ){aZ.remove();}if(Y.subAction===aF){this.isLoading=t;if(Y.firstBatch&&this.filter.category){this.moduleapi.broadcast(Q,{category:""});}}T.later(ah,this,function(){this.body.setStyle(aH,ag);});},fetchContentIds:function(){var Y,aZ;Y={_subAction:av,listid:this.listId,blogtype:this.blogType,key:this.getContinuationKey()};if(!this.clientPagination||!Y.key){return;}this.isLoading=M;aZ={success:function(a3){var a0,a2,a1=this.body.one(aM);if(a3&&a3.data){a0=a3.data.items;a2=a3.data.dynamicCategories;if(a3.data.fbcount&&a1){a1.append("<!-- fb="+a3.data.fbcount+" uuids -->");}}this.isLoading=t;if(a0&&T.Lang.isArray(a0)){this.items=this.removeDuplicates(a0,this.items,a1?a1.all(ao):[],this.closeEnabled?this.storage.getSet(aa,M):[]);}if(a2&&T.Lang.isArray(a2)){this.moduleapi.broadcast(P,{dynamicCategories:a2});}if(this.items.length===0){this.handleStreamEnd();}else{this.checkScroll();}},failure:function(a0){if(this.transportHelperService.wasAborted(a0)){return;}this.isLoading=t;if(this.items.length===0){this.handleStreamEnd();}}};this.streamLoadReqObj=this.loadContent(Y,{},aZ);},loadNextBatch:function(Y,a1){if(this.isLoading){return;}var a2=this.body.one(ae),a0,a3,aZ;if(!a2){return;}aZ=this.items.splice(0,this.batchSize);a0={_subAction:aF,items:aZ,listid:this.listId,blogtype:this.blogType,left:this.items.length,key:this.getContinuationKey(a2),cpos:this.contentpos};if(a1){a0.data=a1;}a3={removeNode:a2,insertNode:a2,insertLoc:"after",firstBatch:Y};if(!Y){this.instrumentation.fireBeacon(a2);}if(a2.hasClass("loading")&&(a0.key||a0.items.length)){this.isLoading=M;a2.setContent(this.moduleapi.getString("STR.LOADING"));this.streamLoadReqObj=this.loadContent(a0,a3);}else{if(a2){this.handleStreamEnd(a2);}}},handleStreamEnd:function(a2){a2=a2||this.getNode(ae+","+J);if(!a2){return;}var aZ=this.dynamicCats,a1=this.filter.category,Y=[],a0=0;if(this.endFiltersEnabled&&aZ&&aZ.length){a2.removeClass(aG).replaceClass("loading",ad);T.Array.each(aZ,function(a3){if(a3.id!==a1&&a0<this.endFiltersCount){Y[a0++]='<a href="#" class="interest-filter rapidnofollow whs-nw" data-action-outcome="slctfltr" data-filter="'+a3.id+'" data-ylk="rspns:nav;t1:a3;t2:strm;t3:ft;sec:strm;ft:2;elm:itm;elmt:fltr;itc:1;cpos:'+a0+';" role="button">'+a3.name+"</a>";}},this);a2.setContent(!Y.length?"":'<h4 class="fz-s">'+this.moduleapi.getString("STR.END_FILTERS_HEADING")+'</h4><p class="fz-s">'+Y.join('<span class="v-h mr-s">, </span>')+"</p>");this.instrumentation.refreshModule(this.rapidContainer);}else{a2.remove();}},setHistoryState:function(aZ,Y){if(aZ&&Y){aZ._expires=+(new Date())+Y;}if(this.restoreStateMethod==="LOCAL_STORAGE"){if(aZ){aZ.href=b.location.href;this.storage.setItem(p,aZ);}else{this.storage.removeItem(p);}}else{if(this.restoreStateMethod==="HTML5_HISTORY"&&am){b.history.replaceState(aZ,"");}else{try{this.getNode(aw).set(aS,T.JSON.stringify(aZ));}catch(a0){}}}},getHistoryState:function(){var Y=ag,a0;if(this.restoreStateMethod==="LOCAL_STORAGE"){Y=this.storage.getItem(p);if(Y&&Y.href!==b.location.href){Y=ag;}}else{if(am){Y=b.history.state;}else{a0=this.getNode(aw);if(a0&&a0.get(aS)){try{Y=T.JSON.parse(a0.get(aS));}catch(aZ){}}}}if(Y){this.setHistoryState(ag);}return(Y&&(!Y._expires||new Date()<Y._expires))?Y:ag;},saveState:function(){var aZ=[],a0=ag,Y=this.clickedItem||this.clickedLink,a1;if(Y){this.body.all(ao).each(function(a2){var a3=a2.getAttribute(n);if(a2.test(al)){return;}else{if(a2.test(ak)){a3="tweet:"+a3;}}aZ.push({u:a3,r:a2.getAttribute(u),i:a2.getAttribute(z)});});a1=this.scrollDomNode.scrollTop;a0={time:this.getNode(aw).getAttribute("data-time"),items:aZ,listId:this.listId,pending:this.items,filter:this.filter,scrollX:this.scrollDomNode.scrollLeft,scrollY:a1,sortBy:this.sortBy,relY:Y.getY()-a1,itemId:(this.clickedItem)?this.clickedItem.getAttribute(n):ag,activeItemId:this.activeItemId||T.Object.getValue(b,["YUI","type_stream","activeItemId"])};}this.setHistoryState(a0,this.restoreStateExpire);},restoreState:function(a5){var a4,aZ,a3=t,a6=this,Y=a6.getHistoryState(),a1=a6.getNode(aM),a0={},a2={};if(this.filter.category===ap&&this.locationPickerEnabled===true){this.initLocation();}if(a1&&Y&&Y.items&&Y.items.length&&T.Object.getValue(Y,["filter","category"])!==ac){a4=(Y.time===a6.getNode(aw).getAttribute("data-time"));a0._subAction=aF;a0.restore=1;a6.activeItemId=Y.activeItemId;a6.sortBy=Y.sortBy;a6.updateControls();if(a4||this.restoreStateOnCacheMiss){aZ=Y.pending;a0.items=Y.items;a0.listid=Y.listId;a0.left=aZ.length;a0.batch=1;a0.cpos=0;a2.insertNode=this.body;a3=M;}else{Y.items=a6.removeDuplicates(Y.items,a1.all(ao));a6.scrollDomNode.scrollLeft=Y.scrollX;a6.scrollDomNode.scrollTop=Y.scrollY;a6.restored=!Y.items.length;a5.call(a6);return;}a6.isLoading=M;a6.filter=Y.filter;a6.loadContent(a0,a2,{success:function(a9,a8){a9.data.items=aZ;delete a9.data.comscore;if(a3){a6.body.all(x).remove();}a6.loadContentSuccess(a9,a8);a6.restored=M;a5.call(a6);var a7=Y.itemId&&a6.getItemByUuid(Y.itemId);a6.scrollDomNode.scrollLeft=Y.scrollX;a6.scrollDomNode.scrollTop=a7?a7.getY()-Y.relY:Y.scrollY;T.later(0,a6,function(){a6.checkScroll();if(a6.pollForNewFrequency){a6.checkForNewContent();}});},failure:function(a8,a7){a6.loadContentFailure(a8,a7);a5.call(a6);}});}else{a5.call(a6);}},updateDocTitle:function(Y){if(!this.newCountInTitleEnabled){return;}if(!this.originalDocTitle){this.originalDocTitle=T.Lang.trim(ar.title);if(!this.originalDocTitle){return;}}var aZ=this.originalDocTitle;if(Y){if(Y>g){aZ=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE.OVERMAX"),{count:g,title:aZ});}else{aZ=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE"),{count:Y,title:aZ});}}ar.title=aZ;},onIdleChange:function(Y){if(this.pollForNewPauseOnIdle){this.pollForNewPaused=Y.idle;if(!this.pollForNewPaused&&this.pollForNewSkipped){this.checkForNewContent();}}},scheduleNewContentPoll:function(){if(this.newContentPoll){this.newContentPoll.cancel();}this.newContentPoll=T.later(this.pollForNewFrequency,this,this.checkForNewContent);},checkForNewContent:function(){if(this.pollForNewPaused){this.pollForNewSkipped=M;return;}if(this.isLoading||this.filter.category||this.sortBy!==a){T.log("skipping checkForNewContent: isLoading="+this.isLoading+", sort="+this.sortBy+", filter="+T.Object.getValue(this.filter,["category"]),"debug","type_stream");this.scheduleNewContentPoll();return;}var Y={_subAction:av,key:0,poll:1},aZ={},a0={success:function(a2){this.pollRequestObj=ag;var a1=T.Object.getValue(a2,["data","items"]),a3;if(a1){a3=this.body.all(ao);a1=this.removeDuplicates(a1,a3.size()?a3:[],this.closeEnabled?this.storage.getSet(aa,M):[],this.items);if(a1.length){this.pendingNewItems=a1;this.broadcastNewContentNotice(a1.length);this.onNewContent();}this.scheduleNewContentPoll();}},failure:function(a1){this.pollRequestObj=ag;}};this.pollRequestObj=this.loadContent(Y,aZ,a0);this.pollForNewSkipped=t;},onNewContent:function(){this.updateDocTitle(this.pendingNewItems.length);if(this.pollForNewAutoInsert){if(this.body.getY()>this.scrollDomNode.scrollTop){this.instrumentation.fireYwaBeacon({action:"insert",sec:"td-strm-new",slk:"insert"});this.insertNewContent();}}else{this.displayNewContentNotice(this.pendingNewItems.length);}},broadcastNewContentNotice:function(aZ){if(!this.pollForNewBroadcastEnabled){return;}var Y="STR.NEWCONTENT.BROADCAST."+(["ZERO","ONE","TWO"][aZ]||"OTHER"),a1=Y&&this.moduleapi.getString(Y)||"",a0=a1&&T.Lang.sub(a1,[aZ])||"";this.moduleapi.broadcast(d,{count:aZ,message:a0});},displayNewContentNotice:function(a0){var a4=this.moduleapi.getString("STR.NEWCONTENT.NOTICE.MESSAGE."+(a0===1?"SINGLE":(a0>g?"OVERMAX":"PLURAL"))),a3=T.Lang.sub(a4,{count:(a0>g?g:a0)}),Y=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.NOTICE.TEMPLATE"),{msg:a3}),a1=this.body.one(aM),a2=T.Node.create(Y),aZ=this.body.one(".newcontentnotice");if(!a1){return;}if(aZ){aZ.replace(a2);}else{a1.insert(a2,"before");this.instrumentation.fireYwaBeacon({action:"secview",sec:"td-strm-msg",outcome:"msgview"});}this.newContentNotice=a2;this.positionNewContentNotice();this.highlightNewItems(ag);},onClickNewContentNotice:function(Y){this.newContentNotice.remove();this.newContentNotice=ag;this.scrollToTop();this.instrumentation.fireBeacon({sec:"td-strm-msg",slk:"top",itc:1});this.insertNewContent();},getMixerActionsForFirstBatch:function(){if(this.filter.category===ac||this.filter.category===ap){return;}var Y=this.getUuids();if(Y.length){this.makeRequestToGetMixerActions(Y,{success:function(aZ){this.markStreamActions(aZ.data.mixerActions);},failure:function(aZ){},scope:this});}},onActionDrawerFeedback:function(Y){this.onDeclareInterest(Y.interestObj,Y.item);},removeStreamItem:function(a1){var aZ=a1.item,a2=!a1.animate?a1.uuid:aZ?aZ.getAttribute(n):ag,Y=this.moduleapi.getString("STR.REMOVE.ITEM.THANKYOU"),a0;if(a2){if(this.filter.category!==ac){if(a1.immediate){aZ.remove();}else{if(a1.animate){if(this.actionDrawerEnabled){aZ.one(".wrapper").addClass("dn");aZ.append(Y);if(aZ.hasClass("featured")){aZ.replaceClass("featured","featured-removed");}if(aZ.one(".fb-friends")){aZ.one(".fb-friends").addClass("dn");}a0=aZ.one(".action-drawer-button-wrapper");if(a0){a0.addClass("dn");}}else{aZ.setContent(Y);}aZ.addClass("remove-item");this.removalTimer=T.later(3000,this,function(){this.fancyRemove(aZ);});}}this.recordClosed(a2);}}},onFlagDone:function(a2){var aZ=a2.item,a3=!a2.animate?a2.uuid:aZ?aZ.getAttribute(n):ag,a1=this.moduleapi.getString("STR.FLAG.ITEM.THANKYOU"),a0,Y;if(a3){if(a2.animate){a0='<li class="flag-thankyou-msg-drawer">'+a1+"</li>";aZ.insert(a0,"after");Y=aZ.get("nextSibling");T.later(3000,this,function(){this.fancyRemove(Y);});}}},recordFlag:function(aZ){var Y=aZ.item,a0=Y?Y.getAttribute(n):ag;if(a0){if(aZ.flag){this.storage.addToSet(az,a0,1,aQ);}else{this.storage.removeFromSet(az,a0);}}},deleteSavedFromActionDrawer:function(Y){this.deleteSavedArticle();},restoreRemovedArticle:function(a0){var a1=a0.one(".action-drawer-button-wrapper"),a2=a0.one("h3 a").get("text").substring(0,8),aZ=a0.getAttribute(n),Y=T.merge(this.instrumentation.getBeaconKeys(a0),{sec:"td-strm-rm",slk:"undo-itm",ltxt:a2,itc:1,action:aC,outcome:"undo"});if(this.removalTimer){this.removalTimer.cancel();a0.one(".remove-wrap").remove();a0.one(".wrapper").removeClass("dn");a0.removeClass("remove-item").removeClass(A);a0.removeClass("y-pattern").removeClass("hover");this.enableStreamButtons({item:a0});if(a0.one(".fb-friends")){a0.one(".fb-friends").removeClass("dn");}if(a1){a1.removeClass("dn");}if(a0.hasClass("featured-removed")){a0.replaceClass("featured-removed","featured");}if(this.actionDrawer&&aZ){if(this.userinfo.isLoggedIn()){this.actionDrawer.markItemFeedbackInMixer(aZ,"neutral","dislike");}this.recordClosed(aZ,M);}this.instrumentation.fireBeacon(Y);}},insertNewContent:function(){var aZ=this.body.one(aM),a2=350,Y=T.Node.create('<li style="height:0">'+this.moduleapi.getString("STR.LOADING")+"</li>"),a1=+(new Date()),a0=function(a3,a4){this.newContentRequestObj=ag;T.later(Math.max(a2,+(new Date())-a1),this,function(){Y.remove();this.updateDocTitle(0);if(!a3&&a4&&a4.html){var a5=T.Node.create("<ul>"+a4.html+"</ul>").all(ao);if(aZ&&a5.size()){aZ.prepend(a5);this.highlightNewItems(a5);if(this.interestsService&&a4.data&&a4.data.interestsData){this.interestsService.set(a4.data.interestsData);}}this.instrumentation.refreshModule(this.rapidContainer);this.cacheNativeAdData();this.pollBatchCount+=1;}});};if(!aZ){return;}aZ.prepend(Y);Y.transition({height:"85px",duration:a2/1000});this.newContentRequestObj=this.loadContent({_subAction:aW,items:this.pendingNewItems,poll:1,ccode:this.ccode,woeid:this.woeId,batch:this.pollBatchCount+1},{},{success:function(a3){a0.call(this,ag,a3);},failure:function(a3){a0.call(this,a3);}});this.pendingNewItems=[];this.broadcastNewContentNotice(0);},getMastheadHeight:function(){var Y=T.one("#masthead");return Y?Y.get(B)-4:0;},scrollToTop:function(){var Y=T.one("#stream")||this.body,aZ=Y.getY()-this.getMastheadHeight();if(this.scrollDomNode.scrollTop>aZ){this.scrollDomNode.scrollTop=aZ;}},positionNewContentNotice:function(a3){if(!this.newContentNotice){return;}var a2=this.newContentNotice,a1=T.one("#stream").one(".filter-bar-section"),Y=this.getMastheadHeight(),a4=a2.hasClass("sticky"),a0,aZ=T.one("BODY");if(a1){Y+=a1.get(B);}a0=(this.scrollDomNode.scrollTop>(this.body.getY()-Y));if(a0&&(!a4||a3)&&aZ.hasClass("fixed-enabled")){a2.setStyles({top:Y+"px",left:this.body.getX()+"px",width:(this.body.get(aL)-parseInt(a2.getComputedStyle("paddingLeft"),10)-parseInt(a2.getComputedStyle("paddingRight"),10))+"px"}).addClass("sticky");}else{if(a4&&(!a0||!aZ.hasClass("fixed-enabled"))){a2.removeClass("sticky").setStyles({top:ag,left:ag,width:ag});}}},highlightNewItems:function(Y){this.body.all("."+aX).removeClass(aX).removeClass(I);if(Y&&Y.size()){Y.addClass(aX);Y.item(Y.size()-1).addClass(I);}},recordRead:function(Y){if(!this.markAsReadEnabled){return;}Y=T.one(Y);if(Y&&Y.hasAttribute(n)&&!Y.test(F)&&!Y.hasClass(aA)){this.storage.addToSet(W,Y.getAttribute(n),1,aQ);Y.addClass("read");}},markRead:function(aZ){if(!this.markAsReadEnabled){return;}var Y=this.storage.getSet(W);if(Y&&T.Object.size(Y)){aZ=aZ||this.body.all(ao);aZ.each(function(a0){var a1=a0.getAttribute(n);if(a1&&Y[a1]){a0.addClass("read");}});}},markFlag:function(aZ){if(!this.flagContentEnabled){return;}if(this.filter.category===ac||this.filter.category===ap){return;}var Y=this.storage.getSet(az);if(Y&&T.Object.size(Y)){aZ=aZ||this.body.all(ao);aZ.each(function(a0){var a1=a0.getAttribute(n);if(a1&&Y[a1]){a0.addClass("flagged");}});}},markStreamActions:function(a2){if(!a2){return;}var aZ=(a2.saveforlater&&T.Lang.isArray(a2.saveforlater))?a2.saveforlater:[],Y=(a2.like&&T.Lang.isArray(a2.like))?a2.like:[],a1=(a2.dislike&&T.Lang.isArray(a2.dislike))?a2.dislike:[],a0;T.Array.each(aZ,function(a3){a0=this.getItemByUuid(a3);if(a0){a0.addClass(aB);}},this);T.Array.each(Y,function(a3){a0=this.getItemByUuid(a3);if(a0){a0.addClass(an);}},this);T.Array.each(a1,function(a3){a0=this.getItemByUuid(a3);if(a0){a0.remove();}},this);},recordClosed:function(aZ,Y){if(!this.closeEnabled||(this.readMixerActions&&this.userinfo.isLoggedIn())){return;}if(Y){this.storage.removeFromSet(aa,aZ);}else{this.storage.addToSet(aa,aZ,1,aQ);}},pruneClosed:function(aZ){if(!this.closeEnabled||this.filter.category===ac){return;}var Y=this.storage.getSet(aa);if(Y&&T.Object.size(Y)&&(this.filter.category!==ap)){aZ=aZ||this.body.all(ao);aZ.each(function(a0){var a1=a0.getAttribute(n);if(a1&&T.Object.owns(Y,a1)){a0.remove();}});}},onDeclareInterest:function(a2,aZ){var a0=this.instrumentation.getBeaconKeys(aZ),Y={"1":"pos","0":"neu","-1":"neg"},a1=this.userinfo.isLoggedIn();if(a1){a0.dcl=Y[a2.current]+"-"+Y[a2["new"]];}a0.itc=1;a0.action=aC;switch(a2.type){case"entity":a0.sec="td-strm-dr";a0.ltxt=a2.id;a0.slk=a2.source?"prvdr":"ent";if(a1){a0.outcm="dclent";}break;case"content":a0.sec="td-strm-ctrl";a0.ltxt=aZ.one("h3 a").get("text").substring(0,8);if(a2.action==="disliked"){a0.rspns=(a2["new"]==="-1")?"rmct":"unrmct";}a0.slk=(a2.action==="liked")?"like":"rm";if(a1){a0.outcm="dclitm";}break;}this.instrumentation.fireBeacon(a0);},initPagination:function(){this.listeners.push(T.after("touchend",this.afterScroll,b,this));this.listeners.push(T.on("resize",function(){this.scrollNodeHeight=this.getScrollNodeHeight();},b,this));if(this.clientPagination){if(this.items.length===0){if(this.pollForNewFrequency||this.dynamicEnabled||this.isInScrollBuffer()){this.fetchContentIds();}else{this.listeners.push(T.onceAfter("scroll",this.fetchContentIds,b,this));}}else{if(this.closeEnabled){this.items=this.removeDuplicates(this.items,this.storage.getSet(aa,M));}}}else{if(this.getContinuationKey()===""){this.batchCount=0;this.loadNextBatch();}}this.scrollBuffer=this.moduleapi.getContextData("scrollBuffer")||this.scrollBuffer;},getContinuationKey:function(aZ){var Y=aZ||this.body.one(ae);if(Y){return Y.hasAttribute("data-key")?Y.getAttribute("data-key"):ag;}return ag;},getNode:function(Y){return T.Lang.isString(Y)?this.body.one(Y):(Y&&this.body.contains(Y)?T.one(Y):ag);},getItemByUuid:function(aZ,Y){Y=Y||this.body;return aZ?Y.one(ao+"["+n+'="'+aZ+'"]'):ag;},getUuids:function(aZ){var Y=aZ||this.body.all(ao),a0=[];Y.each(function(a2){var a1=a2.hasAttribute(n)&&a2.getAttribute(n);if(a1){a0.push(a1);}});return a0;},fancyRemove:function(aZ){var Y=this;aZ=aZ&&T.one(aZ);if(!aZ||!aZ.inDoc()){return;}aZ.transition({height:0,opacity:0,duration:0.4,easing:"ease-in"},function(){aZ.remove();aZ=ag;Y.repaint();});},repaint:function(){if(T.UA.ie&&T.UA.ie<8){this.body._node.className=this.body._node.className;}},setupScroll:function(){var Y=ar.body||T.Node.getDOMNode(T.one("body"));this.scrollDomNode=this.isRmp?T.Node.getDOMNode(this.body.ancestor(function(a0){var aZ=a0.getStyle("overflowY");return(aZ==="scroll"||aZ==="auto"||a0.compareTo(Y));})):Y;this._scrollNodeIsBody=(this.scrollDomNode===Y);if(this._scrollNodeIsBody&&!T.UA.webkit){this.scrollDomNode=ar.documentElement;}this.scrollNodeHeight=this.getScrollNodeHeight();if(this.scrollListener){this.scrollListener.detach();}this.scrollListener=T.one(this._scrollNodeIsBody?b:this.scrollDomNode).after("scroll",this.afterScroll,this);},getScrollNodeHeight:function(){var aZ=this.scrollDomNode,Y=this._scrollNodeIsBody;if(Y&&T.UA.webkit){aZ=ar.documentElement;}return(Y&&T.UA.ios)?b.innerHeight:aZ.clientHeight;},isInScrollBuffer:function(){var aZ=this.body.get("region"),Y=this.body.get("viewportRegion");if(this.registerRapidInViewport&&aZ.height>0&&aZ.top<=Y.bottom){this.registerWithRapid();this.registerRapidInViewport=t;}return(aZ.height>0&&aZ.bottom<(Y.bottom+this.scrollBuffer));},checkScroll:function(){if(this.newContentNotice){this.positionNewContentNotice();}if(this.isInScrollBuffer()){if(!this.batchPause||this.batchCount%this.batchPause){this.loadNextBatch();}}if(this.pollForNewAutoInsert&&this.pendingNewItems.length){this.onNewContent();}this.beaconVisibleNativeAds();},onClick:function(a5){var a0=T.one(a5.target),a2="#"+T.DOM.generateID(this.body),a6=a0.ancestor(ao,M,a2),a1=a6&&"#"+T.DOM.generateID(a6),a7=a0.ancestor("a",M,a2),a3,Y="",aZ="",a4={};if(a7&&a7.hasClass("fp-article")){a3=a0.ancestor(".fp-open-inline",true);if(a3&&a6.hasClass("fp-bday")){a5.preventDefault();a4={name:a6.getData("bday-name"),bday:a6.getData("bday-date"),hash:a6.getData("bday-hash"),id:a6.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"td-strm",ct:"birthday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:T.JSON.stringify(a4)});}else{if(this.inlineLightboxEnabled&&a3){if(a3.getAttribute("data-uuid")){Y=a3.getAttribute("data-uuid");}if(a3.getAttribute("href")){aZ=a3.getAttribute("href");}else{aZ=a3.one("A.rapidnofollow").getAttribute("href");}a5.preventDefault();this.moduleapi.broadcast("fp:open-inline",{uuid:Y,href:aZ,sec:"td-strm",ct:"1"});return;}}}if(a0.hasClass("fblink")){return;}if(a0.ancestor(".social-actions",M,a2)&&this.swipeMenu){this.swipeMenu.onClick(a5);return;}if(a0.test(ae+" button")){this.loadNextBatch();return;}if(a0.test('input[name="sb"]')){this.setSortMode(parseInt(a0.get(aS),10),M);return;}if(a0.ancestor(".see-more-button",M,".type_stream")){this.toggleCollapsibleStream(a0.ancestor(".see-more-button",M));return;}if(a7&&a7.test(m)){this.onAdInfoClick(a7,a6);}if(a0.hasClass("interest-filter")){a5.halt();this.moduleapi.broadcast(Q,{category:a0.getAttribute("data-filter"),name:a0.getAttribute("data-filter-name")||a0.getContent()});this.filterBeacon(a0);return;}if(a6){if(a6.hasClass("remove")&&a0.ancestor(".menu",M,a1)){this.onRemovalMenuClick(a5);}else{if(this.actionDrawer&&a0.ancestor(aJ,M,a1)){this.actionDrawer.toggleDrawer(a6,t);}else{if(this.actionDrawer&&a0.ancestor(".close,.check-icon,.save-button,.flag-content-btn",M,a1)){if(!a0.ancestor("button:disabled",M,a1)){this.handleActionDrawerTrigger(a6,a0);}}else{if(this.actionDrawer&&a0.ancestor(".undo-btn",M,a1)){this.restoreRemovedArticle(a6);}else{if(a0.ancestor(".close",M,a1)){a5.preventDefault();if(a6.hasAttribute(n)){if(this.saveForLaterWidget&&this.filter.category===ac){this.deleteSavedArticle(a0);}else{this.removeContent(a6);}}else{this.fancyRemove(a6);}}else{if(a0.hasClass("share-drawer-icon")){a5.preventDefault();}else{if(a0.ancestor(".share-drawer, .friends-string, .label, .sponsorship",M,a1)){}else{if(a6.hasClass("video-inline")&&this.handleInlineVideo(a6,a0)){a5.preventDefault();}else{if(a7){if(!a0.hasClass("interest-filter")){this.recordRead(a6);}if(a5.which!==2&&a5.button!==4&&!a5.altKey&&!a5.ctrlKey&&!a5.shiftKey&&!a5.metaKey&&a7.getAttribute("target").toLowerCase()!=="_blank"){this.clickedItem=a6;this.clickedLink=ag;if(this.restoreStateExpire&&!a6.hasClass("rss-fallback")){this.saveState();}if(this.itemClickContext){this.statemgr.setUserModuleState("context",{cat:this.filter.category,catName:this.filter.name||"",listid:this.listId||"",blogtype:this.blogType||"",u:a6.getAttribute(n)});}if(this.highlightActive){this.highlightItem(a6);}}}}}}}}}}}}this.moduleapi.broadcast(ax);},handleActionDrawerTrigger:function(a9,a0){var a2=a9&&"#"+T.DOM.generateID(a9),a1=a0.ancestor(".close",M,a2)?A:a0.ancestor(".check-icon",M,a2)?an:a0.ancestor(".flag-content-btn",M,a2)?r:aB,Y,a7=this.userinfo.isLoggedIn(),a6,a8,aZ=(a9.hasClass(ay)&&a9.get("nextSibling")&&a9.get("nextSibling").hasClass("action-drawer"))?a9.get("nextSibling"):ag,a5,a4,a3;if(a9.get("nextSibling")&&a9.get("nextSibling").hasClass("flag-thankyou-msg-drawer")){a9.get("nextSibling").remove();a9.removeClass("y-pattern").removeClass("hover");}this.onHideTooltip();if(a1===an){a5=A;a4=r;a3=aB;}else{if(a1===A){if(this.filter.category===ac){this.actionDrawer.toggleDrawer(a9,M);this.actionDrawer.handleSaveClick();return;}a5=an;a4=r;a3=aB;}else{if(a1===aB){a5=an;a4=A;a3=r;}else{if(a1===r){a5=an;a4=A;a3=aB;}}}}a9.toggleClass(a1);if(a1===aB){a6=a7;a8=a7?t:!a9.test("."+an+",."+A+",."+r);}else{a6=!a9.hasClass(ay)&&!a9.hasClass(a1);a8=a7?(!aZ||!aZ.test("."+a5+",."+a4)):(!a9.test("."+a5+",."+a4+",."+a3));}if(!a9.hasClass(ay)||a8){this.actionDrawer.toggleDrawer(a9,a6,a1);}if(a7||(this.nonPersonalStream&&(a1===A))){if(a1===an){this.actionDrawer.handleLikeClick();}else{if(a1===A){this.actionDrawer.handleDislikeClick();Y=a9.getAttribute(n);this.recordClosed(Y,!a9.hasClass(A));}else{if(a1===aB){this.actionDrawer.handleSaveClick();}else{if(a1===r){this.actionDrawer.handleFlagClick();}}}}this.instrumentation.refreshModule(this.rapidContainer);}else{a9.removeClass(a5).removeClass(a4).removeClass(a3);if(this.actionDrawer.currentDrawer){this.actionDrawer.showLoginBtns();}else{if(a1===an||a1===A){this.actionDrawer.fireItemInterestChange("0",a1===an?"1":"-1",a1);}}}a9.one("h3 a").focus();},disableStreamButtons:function(aZ){var Y=aZ?aZ.item:ag;if(Y){Y.all(".side-button").set(o,M);}},enableStreamButtons:function(aZ){var Y=aZ?aZ.item:ag;if(Y){Y.all(".side-button").set(o,t);}},handleInlineVideo:function(a0,Y){var a1,aZ,a2,a3=ag;if(!this.yepService){this.yepService=this.moduleapi.getService("videoyep");if(this.yepService){this.yepPlayer=this.yepService.create();}}if(!this.yepPlayer){return t;}a1=a0.getData();if(!a1.uuid){return t;}if(a1["poster-img"]){a3=a1["poster-img"];}aZ=this.instrumentation.getBeaconKeys(a0);a2={analytics:{sec:aZ.sec,ccode:this.ccode,cpos:aZ.cpos,ct:aZ.ct||3},config:{animated:M,attach:a0,location:"prepend",returnTabIndexTo:Y,yep:{autoplay:M,id:a1.uuid},videoPageUrl:a1.url||ag}};if(a3){a2.config.image=a3;}this.yepPlayer.init(a2);this.recordRead(a0);return M;},onRemovalMenuClick:function(ba){var a1=ba.target,a8,bc=a1.ancestor(ao,M,"#"+T.DOM.generateID(this.body)),a3=T.merge(this.instrumentation.getBeaconKeys(bc),{itc:1,pos:0}),a4,a6,a0,a2,a7,a5,Y,a9={},aZ=[],bb=this;if(a1.ancestor("button.undo",M)){this.clearRemovalTimer();Y=bc.getAttribute(n);this.recordClosed(Y,M);bc.one(".menu").remove();bc.removeClass(aY);this.currentRemovalMenu=ag;a4=bc.one(".wrapper .body h3 a").get("text");a4=(a4&&a4.length>8)?a4.substring(0,8):a4;this.instrumentation.fireBeacon(T.mix({action:aC,outcome:"undo",sec:"td-strm-rm",slk:"undo",ltxt:a4},a3));this.repaint();if(this.userinfo.isLoggedIn()&&this.writeMixerActions){a5={_subAction:"article_feedback",uuid:Y,state:"neutral",mixerAction:"dislike"};this.makeInterestRequest(a5);}bc.one(".wrapper .body a").focus();}else{if(a1.ancestor(".wikiid",M,".menu")){a8=a1.ancestor(".wikiid",M,".menu");a7=a8.hasClass(aE)?1:a8.hasClass(X)?-1:0;if(a1.hasClass("remove-title")){if(a8.hasClass(aE)){a8.replaceClass(aE,X);}else{if(a8.hasClass(X)){a8.removeClass(aE).removeClass(X);}else{a8.replaceClass(X,aE);}}}else{if(a1.ancestor(".remove-pos",M,".wikiid")){a8.toggleClass(aE).removeClass(X);}else{if(a1.ancestor(".remove-neg",M,".wikiid")){a8.toggleClass(X).removeClass(aE);}else{a8.toggleClass(X);a8.removeClass(aE);}}}a0=a8.hasClass(aE)?1:a8.hasClass(X)?-1:0;a4=a8.getAttribute(aV);a2=((a7===1)?"pos":(a7===-1)?"neg":"neu")+"-"+((a0===1)?"pos":(a0===-1)?"neg":"neu");a9[a4]={"new":a0,current:a7,type:a8.getAttribute("data-interesttype")};aZ=a9;this.handleRemovalMenuFeedback(aZ,function(be,bf){var bd;if(bb.currentRemovalMenu&&bb.currentRemovalMenu===bc){if(be===t){if(bb.interestsService){bb.interestsService.update(a4,{state:a0});}bd=a1.ancestor(".remove-menu-main",M,"div");if(!bd.getData("confirmed")){bd.append(bb.moduleapi.getString("STR.BUTTON.REMOVE_DONE"));bd.setData("confirmed",M);bb.repaint();}}else{if(a7===1){a8.replaceClass(X,aE);}else{if(a7===-1){a8.replaceClass(aE,X);}else{a8.removeClass(X).removeClass(aE);}}}}});a6=bc.one(".login");if(a6){a6.removeClass(ab);this.repaint();}if(this.userinfo.isLoggedIn()){this.instrumentation.fireBeacon(T.mix({sec:"td-strm-rm",slk:a2,ltxt:a4,action:aC,outcome:"entitydecl"},a3));}}else{if(a1.ancestor("button.remove-done",M)){bc.one(".menu").empty().setStyle("minHeight",0).append(bb.moduleapi.getString("STR.REMOVE.CONFIRM"));bc.addClass("remove-disappear");bc.removeClass("featured");this.setRemovalTimer();this.repaint();this.instrumentation.fireBeacon(T.mix({slk:"done",ltxt:"done"},a3));}}}},afterScroll:function(Y){if(this.scrollTimer){this.scrollTimer.cancel();}var aZ=+(new Date()),a0=aZ-this.lastScrollCheck;if(a0>this.scrollThrottle){this.checkScroll();this.lastScrollCheck=aZ;}else{this.scrollTimer=T.later(this.scrollThrottle-a0,this,this.checkScroll);}},onHoverContent:function(Y){var a0=Y.currentTarget,aZ=Y.relatedTarget;if(a0!==aZ&&!a0.contains(aZ)){a0.toggleClass(k,(Y.type===O));}},onHoverTitle:function(Y){var aZ=Y.target.ancestor(ao);if(aZ){aZ.toggleClass(af,Y.type===O);}},onMouseOverMenu:function(Y){this.clearRemovalTimer();},onMouseOutMenu:function(Y){this.setRemovalTimer();},onMouseOverLi:function(Y){var aZ=Y.currentTarget;this.trimEntityList(aZ);},trimEntityList:function(aZ){var Y=aZ.one(".interest-list"),a0=Y?aZ.one(".attribution").get("region"):ag,a1;if(Y&&!aZ.hasClass("remove")){Y.removeClass("dn");Y.removeClass("voh");a1=Y.all(".interest-wrap");while(a1.size()&&!Y.inRegion(a0,M)){a1.pop().remove();}}},onMouseOutLi:function(Y){var aZ=Y.currentTarget;this.hideEntityList(aZ);},hideEntityList:function(aZ){var Y=aZ.one(".interest-list");if(Y){Y.addClass("voh");}},onShowTooltip:function(Y){this.showTooltip(Y.currentTarget);},showTooltip:function(a1){var a0=this.tooltip.getNode(),aZ=this.moduleapi,Y=a1.ancestor(ao),a3,a2;if(a1.hasClass("side-button")&&this.actionDrawerEnabled){a0.addClass("whs-nw");if(a1.hasClass("save-button")){a2=Y.hasClass("saved")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.SAVE.SAVETEXT");a0.addClass(aT);}else{if(a1.hasClass("check-icon")){a2=Y.hasClass("liked")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.INTERESTS.LIKETEXT");a0.addClass(aR);}else{if((this.filter.category===ac)||this.nonPersonalStream){a2=aZ.getString("STR.INTERESTS.REMOVETEXT");a3=this.nonPersonalStream?aP:aO;a0.addClass(a3);}else{if(a1.hasClass("close")){a2=Y.hasClass("disliked")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.INTERESTS.DISLIKETEXT");a0.addClass(aP);}else{if(a1.hasClass("flag-content-btn")){a2=Y.hasClass("flagged")?aZ.getString("STR.TOOLTIP.UNDO"):aZ.getString("STR.INTERESTS.FLAGTEXT");a0.addClass(aN);}}}}}}else{if(a1.hasClass("profile-img")){a2=a1.one("img").get("alt");}else{if(a1.hasClass("more")){a2=a1.getAttribute("data-friendlist").split(",").join("<br/>");}}}if(a2){this.tooltip.show(a1,{msg:a2});}},onHideTooltip:function(Y){this.tooltip.hide();this.tooltip.getNode().removeClass(aT).removeClass(aR).removeClass(aP).removeClass(aO).removeClass(aN).removeClass("whs-nw");},onFilter:function(Y){if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ag;}if(this.newContentRequestObj){this.newContentRequestObj.abort();this.newContentRequestObj=ag;}this.filter=Y||{};this.listId=(Y.category&&Y.category.indexOf("LISTID:")===0)?Y.category.slice(7):"";this.batchCount=0;this.contentpos=0;this.isLoading=t;this.items=[];this.pendingNewItems=[];this.broadcastNewContentNotice(0);this.body.setStyle(aH,Math.max(parseInt(this.body.get(B),10),60)+"px");this.body.all(x).remove();this.body.append(this.moduleapi.getString("STR.LOADING.CONTENT"));T.later(ah,this,this.scrollToTop);this.clearRemovalTimer();this.currentRemovalMenu=ag;this.updateDocTitle(0);this.updateControls();this.clearNativeAdData();this.loadNextBatch(M);if(this.saveForLaterWidget&&(Y.category===ac)){this.saveForLaterWidget.onSavedFilter();}if(this.actionDrawer){this.actionDrawer.onFilter(Y);}if(this.swipeMenu){this.swipeMenu.onFilter(Y);}},removeDuplicates:function(Y){var a0={},aZ=[];if(Y&&Y.length){if(arguments.length>1){T.each(T.Array(arguments).slice(1),function(a1){T.each(a1,function(a2){if(!a2){return;}if(a2 instanceof T.Node){a0[a2.getAttribute(n)]=1;if(a2.hasAttribute(G)){a0[a2.getAttribute(G)]=1;}if(a2.hasAttribute(E)){a0[a2.getAttribute(E)]=1;}}else{if(T.Lang.isObject(a2)){a0[a2.u]=1;if(a2.ka){a0[a2.ka]=1;}if(a2.kb){a0[a2.kb]=1;}}else{a0[a2]=1;}}});});T.each(Y,function(a1){if((!a0.hasOwnProperty(a1.u))&&(!a1.ka||!a0.hasOwnProperty(a1.ka))&&(!a1.kb||!a0.hasOwnProperty(a1.kb))){aZ.push(a1);}});}else{aZ=Y.slice(0);}}return aZ;},showRemovalMenu:function(a1){var a5=a1.one(".wrapper"),a0=this.parseInterests(a1),Y=a5.get(B),a3,aZ,a4,a2;a1.addClass(aY);aZ=this.moduleapi.getString("STR.REMOVE.MENU");a3=a1.appendChild(aZ);a4=a3.one(".remove-menu-main");a2=a3.one(".profile-link");a3.setStyle("minHeight",Y);if(a0.length){a4.append(this.moduleapi.getString("STR.SHOW.LESS"));if(a2){a2.removeClass(V);}T.Array.each(a0,function(a6){a6.type=a6.declared?"declared":"";a6.selected=a6.state===1?aE:a6.state===-1?X:"";a4.append(T.Lang.sub(this.moduleapi.getString("STR.BUTTON.WIKIID"),a6));},this);}this.repaint();this.currentRemovalMenu=a1;},handleRemovalMenuFeedback:function(aZ,a3){if(!this.userinfo.isLoggedIn()){return;}var Y,a1;function a2(a4){if(T.Lang.isFunction(a3)){a3(t,a4);}}function a0(a4){if(T.Lang.isFunction(a3)){a3(M,a4);}}Y={_subAction:"int_manage",interest:aZ};a1={success:a2,failure:a0,scope:this};this.makeInterestRequest(Y,a1);},makeRequestToGetMixerActions:function(Y,aZ){this.transportHelperService.makeRequest({type:"module",moduleId:this.id,args:{_action:"show",_subAction:"getMixerActions",uuids:Y}},aZ);},makeInterestRequest:function(Y,aZ){var a0=aZ?aZ:{};this.transportHelperService.makeRequest({type:"module",moduleId:R,args:T.merge({_action:"show"},Y)},a0);},onRemovalMenuLoginClick:function(a1){var a0=a1.ancestor(ao,M,"#"+T.DOM.generateID(this.body)),aZ=T.mix(this.instrumentation.getBeaconKeys(a0),{itc:1,pos:0}),a3=a1.get("text"),a4={},a2=t,Y=[];a3=(a3&&a3.length>8)?a3.substring(0,8):a3;this.clearRemovalTimer();this.currentRemovalMenu=ag;a0.all("span.wikiid").each(function(a6){var a8=a6.getAttribute(aV),a5="neu-"+(a6.hasClass(aE)?"pos":a6.hasClass(X)?"neg":""),a7=a6.hasClass(aE)?1:a6.hasClass(X)?-1:0;if(a6.hasClass(aE)||a6.hasClass(X)){a4[a8]={"new":a7,current:0,type:"declared"};a2=M;Y.push(T.merge(aZ,{slk:a5,ltxt:a8}));}});if(a2){this.storage.setItem(aK,{wikiids:a4,beacons:Y});}this.storage.setItem(aj,a1.hasClass("fblogin")?aU:h);},updateDislikedInterests:function(){if(!this.removalMenuEnabled){return;}var Y;if(!this.userinfo.isLoggedIn()){this.loginService.configClick({selector:".type_stream .remove a",clickHandler:T.bind(this.onRemovalMenuLoginClick,this)});}else{Y=this.storage.getItem(aK);if(Y){if(T.Object.size(Y.wikiids)>0){this.handleRemovalMenuFeedback(Y.wikiids,M);}T.Array.each(Y.beacons,function(aZ){this.instrumentation.fireBeacon(aZ);},this);this.storage.removeItem(aK);}this.storage.removeItem(aj);}},parseInterests:function(aZ){var Y=aZ&&aZ.hasAttribute(c)?aZ.getAttribute(c):ag,a0=Y?T.Object.values(this.interestsService.get(Y.split("|"))):[];T.Array.each(a0,function(a1){a1.streamEligible=(a1.url&&(a1.count>=this.minArticleCount));},this);return a0;},clearRemovalTimer:function(Y){if(this.itemRemovalTimer){this.itemRemovalTimer.cancel();this.itemRemovalTimer=ag;}},setRemovalTimer:function(){this.itemRemovalTimer=T.later(5000,this,function(){this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ag;});},removeContent:function(a0){var aZ,Y;a0=T.one(a0);if(a0&&a0.hasAttribute(n)){aZ=a0.getAttribute(n);this.recordClosed(aZ);if(this.removalMenuEnabled){if(this.currentRemovalMenu){this.clearRemovalTimer();this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ag;}this.showRemovalMenu(a0);}else{if(!this.swipeMenu){this.fancyRemove(a0);}}if(this.userinfo.isLoggedIn()&&this.writeMixerActions){Y={_subAction:"article_feedback",uuid:aZ,state:"disliked",mixerAction:"dislike"};this.makeInterestRequest(Y);}this.instrumentation.fireYwaBeacon(T.mix({itc:1,action:aC,outcome:"rmct",slk:"rm",sec:"td-strm-ctrl"},this.instrumentation.getBeaconKeys(a0)));}},setSortMode:function(a1,aZ){var a0=this.instrumentation,Y;if(a1===this.sortBy){return;}this.sortBy=a1;this.statemgr.saveUserSetting("sb",a1,this.moduleapi);this.onFilter(this.filter);if(aZ){this.updateControls();Y=(a1===a?"sort-t":"sort-c");a0.fireBeacon({sec:"set-strm",itc:1,slk:Y,action:aC,outcome:"sort"});}},toggleCollapsibleStream:function(a1){var a2=this.body.all(ao),a0=a2.filter(".expanded-item"),aZ=a1.one("i"),a3,Y={sec:"td-strm",elm:"btn",itc:1,action:aC};if(a1.hasClass("expand")){a1.setHTML(this.moduleapi.getString("STR.STREAM.COLLAPSE")+" "+aZ.get("outerHTML"));a3=M;Y.slk="xpnd";Y.elmt="xpnd";a1.removeClass("expand");a0.removeClass("dn");}else{a1.setHTML(this.moduleapi.getString("STR.STREAM.EXPAND")+" "+aZ.get("outerHTML"));a3=t;Y.slk="clps";Y.elmt="clps";a1.addClass("expand");a0.addClass("dn");}a2.removeClass("no-bottom-border").filter(":not(.dn)").pop().addClass("no-bottom-border");this.instrumentation.fireBeacon(Y);this.statemgr.saveUserSetting("es",a3,this.moduleapi);T.Global.fire("pane-manager:sync-nav-pane-scroll");},updateControls:function(){var Y=this.body.one(".controls"),aZ,a0,a1=this.filter.category,a2=this.sortBy;if(!Y){return;}aZ=Y.one(".sort");Y.all(at).removeClass(i);if(aZ){if(a1===ap){aZ.addClass(o).setAttribute(o,o);a2=a;}else{aZ.removeClass(o).removeAttribute(o);}a0=aZ.one('input[value="'+a2+'"]');if(a0){a0.set(i,M).ancestor(at).addClass(i);}}},filterBeacon:function(a0){var aZ,a1,Y={ltxt:a0.getContent(),cpos:a0.get("parentNode").all(".interest-filter").indexOf(a0)+1,itc:1};if(a0.ancestor(J)){Y.sec="fltr-strm-ft";Y.slk="filter-d";this.instrumentation.fireBeacon(Y);}else{if(a0.ancestor(".interest-list")){aZ=a0.ancestor(ao);a1=this.instrumentation.getBeaconKeys(aZ);Y.slk="filter-i";Y.sec=a1.sec;Y.g=a1.g;Y.woe=this.woeid;Y.ccode=this.ccode;Y.intl=this.intl;this.instrumentation.fireBeacon(Y);}}},deleteSavedArticle:function(Y){if(this.saveForLaterWidget){this.saveForLaterWidget.deleteArticle(Y);}var aZ=this.body.all(ao),a0=this.body.one(".strm-error-msg");if(this.filter.category===ac&&a0&&aZ&&aZ.size()===0){a0.removeClass(V);}this.updateSflHeader(aZ.size());},updateSflHeader:function(aZ){var a0=this.body.one(".saved-stories-header"),Y;if(a0){Y=a0.one(".saved-header-count");if(Y){Y.setHTML(aZ);}if(aZ===0){a0.one(".saved-header-count-wrap").addClass("d-n");}}},onSaveArticle:function(a0,Y){if(!a0){return;}var aZ=T.merge(this.instrumentation.getBeaconKeys(a0),{sec:"td-strm-ctrl",slk:Y,itc:1,action:aC,outcome:((Y==="sv")?"svct":"undo")});this.instrumentation.fireBeacon(aZ);},onSignedOutSaveClick:function(aZ){if(!aZ){return;}var Y=T.merge(this.instrumentation.getBeaconKeys(aZ),{sec:"td-strm-ctrl",action:aC,outcome:"login"});this.instrumentation.fireYwaBeacon(Y);},registerWithRapid:function(){var a0=this.instrumentation,aZ=this.rapidContainer,Y=a0.getBeaconKeys(aZ);if(a0.isModuleTracked(aZ)){a0.refreshModule(aZ);}else{a0.addModule(aZ,Y&&Y.sec?Y.sec:"td-strm");}},cacheNativeAdData:function(){var Y=this.body.all(al+"["+aI+"]");this.clearNativeAdData();if(Y.size&&Y.size()>0){Y.each(function(a0,aZ){this.nativeAds.push({node:a0,y:a0.getY(),height:a0.get(B)});},this);return true;}return false;},clearNativeAdData:function(){this.nativeAds=[];},beaconVisibleNativeAds:function(){var a0,aZ,Y,a1;if(this.nativeAds.length>0){a0=this.scrollDomNode;aZ=this.getScrollNodeHeight();Y=this.nativeAds.length-1;while(Y>=0){a1=this.nativeAds[Y];if(((a0.scrollTop+aZ)>(a1.y+(a1.height/2)))&&(a0.scrollTop<a1.y)){this.fireNativeAdBeaconWhenReady(a1);this.nativeAds.splice(Y,1);}Y--;}}},fireNativeAdBeaconWhenReady:function(Y){T.later(1000,this,function(){var a0,a2,a1=this.scrollDomNode,aZ=this.getScrollNodeHeight();if(((a1.scrollTop+aZ)>(Y.y+(Y.height/2)))&&(a1.scrollTop<Y.y)){a0=Y.node.getAttribute(aI);a2=Y.node.getAttribute(e);if(a0){this.instrumentation.getBeaconImage(a0);Y.node.removeAttribute(aI);}if(a2){this.instrumentation.getBeaconImage(a2);Y.node.removeAttribute(e);}}else{this.nativeAds.push(Y);}});},onAdInfoClick:function(a1,a0){var aZ=this.instrumentation.getBeaconKeys(a0),Y=a1.test(aq)?"sp":a1.test(f)?"adv":"info";this.instrumentation.fireYwaBeacon(T.mix(aZ,{slk:Y,ad:1,action:"click",rspns:"nav"}));},initGlobalListeners:function(){this.listeners.push(T.Global.on("media:remove-node",function(Y){if(Y.node.contains(this.body)){this.onviewunload("default");}},this));this.listeners.push(T.Global.on(K+":initialized",this.onReqMgrInitialized,this));this.listeners.push(T.Global.on(K+":active-content-changed",this.onReqMgrActiveContentChange,this));this.listeners.push(T.Global.on("pane-manager:scroll-mode-change",this.setupScroll,this));this.listeners.push(T.Global.on(Q,function(Y){this.moduleapi.broadcast(Q,Y);},this));},onReqMgrInitialized:function(Y){if(Y&&Y.metadata){this.substituteDataInTemplate(Y.metadata);}},onReqMgrActiveContentChange:function(a0){var Y=T.Object.getValue(a0,["uuid"]),aZ=Y&&this.getItemByUuid(Y)||ag;b.YUI.namespace("type_stream").activeItemId=this.activeItemId=Y;if(aZ&&this.interestFiltersBroadcast){this.broadcastEntities(aZ);}if(this.highlightActive){this.highlightItem(aZ);}},substituteDataInTemplate:function(aZ){var Y=aZ&&aZ.uuid&&this.getItemByUuid(aZ.uuid);if(Y&&Y.hasClass(V)){if(aZ.url&&aZ.title){aZ=T.merge({summary:aZ.description||"",pubdate:"",attribution:""},aZ);Y.setHTML(T.Lang.sub(Y.getHTML(),aZ)).removeClass(V);}else{Y.remove();}}},highlightItem:function(Y){this.body.all(l).removeClass(q);if(Y&&!Y.hasClass(aA)){Y.addClass(q);}},broadcastEntities:function(aZ){var a0={url:"",uuid:"",entities:[]},Y;if(aZ){Y=aZ.one("h3 a");if(Y){a0.url=Y.getAttribute("href");}if(aZ.hasAttribute(n)){a0.uuid=aZ.getAttribute(n);}if(this.interestFiltersBroadcast&&aZ.hasAttribute(c)){a0.entities=this.parseInterests(aZ);}}if(!this.evtStreamEntities){this.evtStreamEntities=T.Global.publish(U,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamEntities);}else{if(this.evtStreamEntities.fireOnce){this.evtStreamEntities.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamEntities.fire(a0);},broadcastDynamicFilters:function(Y){if(!this.evtStreamDynamicFilters){this.evtStreamDynamicFilters=T.Global.publish(H,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamDynamicFilters);}else{if(this.evtStreamDynamicFilters.fireOnce){this.evtStreamDynamicFilters.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamDynamicFilters.fire(Y);}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("storage_service",function(d){var i="MPServices",e="StorageProvider",f=true,h=false,g=null,a={},b={},j=g;function c(k){this._moduleId=k;this.onReady(function(){this.ready=f;},this);}c.prototype={_moduleId:g,ready:h,onReady:function(l,k){d.StorageLite.on("storage-lite:ready",function(){l.call(k);});},getItem:function(k){var l;try{l=b[k]||d.StorageLite.getItem(k,f);}catch(m){j.logError(this._moduleId,m.message);}finally{if(l&&d.Object.owns(l,"$v")&&(!l.$e||l.$e>+(new Date()))){b[k]=l;return l.$v;}delete b[k];return g;}},setItem:function(l,p,k){var m;try{m={$v:p,$e:k?+(new Date())+k:0};d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(o){if(/QUOTA_EXCEEDED_ERR/.test(o.message)){try{d.StorageLite.removeItem(l);d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(n){j.logError(this._moduleId,n.message);}}else{j.logError(this._moduleId,o.message);}return h;}},removeItem:function(k){try{delete b[k];d.StorageLite.removeItem(k);return f;}catch(l){j.logError(this._moduleId,l.message);return h;}},getSet:function(k,n){var p=this.getItem(k),m=+(new Date()),o=h,l={};d.Object.each(p,function(r,q){if(d.Object.owns(r,"$v")&&(!r.$e||r.$e>m)){l[q]=r.$v;}else{o|=delete p[q];}});if(o){this.setItem(k,p);}return n?d.Object.keys(l):l;},addToSet:function(l,m,n,k){var o=this.getItem(l)||{};o[m]={$v:n,$e:k?+(new Date())+k:0};return this.setItem(l,o);},removeFromSet:function(k,l){var m=this.getItem(k);if(m&&d.Object.owns(m,l)){delete m[l];return this.setItem(k,m);}return h;}};d.namespace(i)[e]={name:"storage",getService:function(l,k){if(!j){j=l.getService("metrologger");}if(!a[k]){a[k]=new c(k);}return a[k];}};if(d.ModulePlatform){d.ModulePlatform.registerService(d[i][e]);}},"0.0.1",{requires:["gallery-storage-lite","metrologger"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("login",function(f){var x=null,B="MPServices",N="LoginProvider",e=f.ModulePlatform,n=f.config.win,A="p_30345826",k="at",F="ylogin",U="fblogin",v="fblink",t="fbrefresh",m="a."+F+",a."+U+",a."+v+",a."+t+",.login-tooltip",p="login:fbinfo_refreshed",I="click",r="vertical",o=/http[s]?:\/\/[\S]*[&|?].done=(.*)/,H=1,E=3,D,a,L,C=x,d,T,R,G=x,i="",b="",q="",M=x,w=[],j;function c(){return G;}function g(){R.one("#cookie-refresh").remove();if(M){M();}}function O(Y){var X=n.location.protocol+"//"+f.config.win.location.host,V=encodeURIComponent(X+"/credstore_proxy/CredStoreEventsProxy.php?callback_function=cookie_refresh"),W='<iframe id="cookie-refresh" src="https://login.yahoo.com/config/refresh_cookie?.done='+V+'" height="0px" width="0px" class="vh"></iframe>';M=Y;R.append(W);}function P(X,V){if(X&&X==="200"){O(function W(){n.location.replace(n.location.href.split("#")[0]);});}else{}}function h(){var W,V;V=f.on("message",function(X){var Y=X._event;if(Y.data&&Y.origin&&/https?:\/\/.*\.yahoo\.com:?[0-9]*$/.test(Y.origin)){if(V&&f.Lang.isFunction(V.detach)){V.detach();}P(Y.data,Y.origin);}});W=n.location.protocol+"//"+n.location.host+"/credstore_proxy/CredStorePopupProxy.php?spid="+T.spid+"&fbperms="+q;n.open(W,"fblink_popup","height=533,width=698,modal=yes,alwaysRaised=yes");}function S(X,W,V){var Y;if(L){Y=L.makeRequest({type:"module",moduleId:A,args:f.merge({_action:"show",_subAction:"getButtons",noups:1},W)},{success:function(Z){if(X&&Z.html){X.setContent(Z.html);}if(f.Lang.isFunction(V)){V();}},failure:function(Z){},scope:this});}}function l(X,Y,Z){var V={success:Z.onSuccess||function(){},failure:Z.onFailure||function(){},scope:this},W={type:"module",moduleId:A,args:{_action:"save",_subAction:X,value:Y}};L.makeRequest(W,V);}function u(){return b;}function J(V){q=V.fbPerms||"email,user_birthday,user_education_history,user_likes,user_location,user_relationships,user_subscriptions,user_work_history,friends_birthday,friends_education_history,friends_likes,friends_location,friends_work_history,publish_actions";i=V.fbAppId||"90376669494";}function Q(X,W){var V=X||i;if(n.FB){if(f.Lang.isFunction(W)){W();}return;}n.fbAsyncInit=function(){n.FB.init({appId:V,channelUrl:n.location.protocol+"//"+n.location.host+"/channel.html",status:true,cookie:true,xfbml:false});if(f.Lang.isFunction(W)){W();}};f.Get.script("//connect.facebook.net/en_US/all.js");}function z(){var W=function(X,Y){D.fireYwaBeacon({action:"reauthfb",rescode:Y});L.broadcast(p,X);if(X===true){f.all("a."+t).hide();}},V=function(){n.FB.getLoginStatus(function(Y){var ab,ac,aa,X,ad,Z;if(Y.status==="connected"){ac="q="+encodeURIComponent('insert into media.social.homerun.credential (accessToken, userID, expiresIn, signedRequest, spid, env) values("'+Y.authResponse.accessToken+'","'+Y.authResponse.userID+'","'+Y.authResponse.expiresIn+'","'+Y.authResponse.signedRequest+'", "'+T.spid+'", "prod")');aa="env="+encodeURIComponent(T.store);X="crumb="+T.crumb;ad=[ac,aa,X,"callback={callback}","format=json"].join("&");Z=["https://"+T.host+T.path+"?",ad];f.jsonp(Z.join(""),function(ae){var af;if(f.Object.getValue(ae,["query","results","result","status"])==="200"){af=f.Object.getValue(ae,["query","results","result","data","results","credential","issued_ts"]);l(k,af,{onSuccess:function(){W(true,0);},onFailure:function(){W(false,3);}});}else{W(false,4);}});}else{ab=(Y.status==="unknown")?1:2;W(false,ab);}});};if(!i){J({});}Q(i,V);}function K(X){var V=X.doneParams||"",W=n.location.protocol+"//"+n.location.hostname+V;n.location.replace(W);}function s(aa){var X=aa.currentTarget,Z=f.DOM.winWidth(),W=n.screen.height,Y=(f.UA.ie)?n.screenLeft:n.screenX,V,ad,ab,ac=a.getProperty("ywa.rapid.enabled.modules");if(X){if(X.test("a."+U)){aa.preventDefault();V=X.getAttribute("href");if(f.Lang.isString(V)&&!o.test(V)){V+=(V.indexOf("?")?"&":"?")+".done="+encodeURIComponent(n.location.href);}if(/https?:\/\/m?login\.yahoo\.com/.test(V)){aa.preventDefault();a.navigate(A,V);}else{ad=(Z+Y>820)?Z+Y-820:0;ab=(W>680)?(W-680)/2:0;n.open(V,"login","width=800,height=680,modal=yes,left="+ad+",top="+ab);}}else{if(X.test("a."+F)){V=X.getAttribute("href");if(f.Lang.isString(V)&&!o.test(V)){V+=(V.indexOf("?")?"&":"?")+".done="+encodeURIComponent(n.location.href);X.setAttribute("href",V);}}else{if(X.test("a."+v)){aa.preventDefault();h();}else{if(X.test("a."+t)){aa.preventDefault();n.open(X.getAttribute("href"),"fbrefresh","width=700,height=500,modal=yes");}}}}if(X.test("a."+F+",a."+U+",a."+v)){if(typeof(ac)=="object"&&ac.hasOwnProperty("default-p_30345826")){D.fireBeacon(D.getBeaconKeys(X));}}if(X.test("a."+F+",a."+U)){f.Array.each(w,function(ae){if(X.test(ae.selector)&&f.Lang.isFunction(ae.clickHandler)){ae.clickHandler(X);}});}}}function y(){var Z={parentNode:R,className:["y-tooltip-login"],pointerClass:"img-sprite",position:{box:"l",arrow:"r"},autohide:true},W={sec:"login-tooltip",cacheKey:"login-svc",layout:r,title:"Sign in to save your preference",narrow:1},aa=[],X,Y,V;V={init:function(){var ab=this;Y=d.create(Z);f.on("scroll",function(){ab.hide();});Y.getNode().on("mouseout",function(){X=f.later(3000,this,function(){ab.hide();});});Y.getNode().on("mouseover",function(){X.cancel();});},_showTooltip:function(ad,ac){var ab=this;if(X){X.cancel();}Y.show(ad,ac);X=f.later(ac.hideDelay||3000,this,function(){ab.hide();});},show:function(ag){var ad=f.mix(ag.buttonConfig||{},W),ac=f.mix(ag.tooltipCong||{},Z),af=this,ae,ab;if(!ag.pointAtMeNode){return;}if(!aa[ad.cacheKey]){ae=f.Node.create("<div></div>");ab=function(){aa[ad.cacheKey]=ae;af._showTooltip(ag.pointAtMeNode,f.mix({msg:ae},ac));};S(ae,ad,ab);}else{f.later(250,this,function(){af._showTooltip(ag.pointAtMeNode,f.mix({msg:aa[ad.cacheKey]},ac));});}},hide:function(){if(Y&&Y.isVisible()){Y.hide();}}};V.init();return V;}j={getTooltip:function(){if(!C){C=new y();}return C;},configClick:function(W){var X=W.clickHandler||x,V=W.selector||"";w.push({selector:V,clickHandler:X});return this;},setupFBApp:J,displayFBLinkingDialog:h,getFBAcctLinkStatus:c,getFBLoginUrl:u,getButtons:S,loadFBSDK:Q,refreshCookie:O,updateFBAccessToken:z};f.namespace(B);f[B][N]={name:"login",getService:function(X,W){var V;D=X.getService("instrumentation");a=X.getService("moduleplatform");d=X.getService("tooltip");L=X.getModuleApi(W);T={spid:a.getProperty("credstore.spid"),host:a.getProperty("yql.host"),path:a.getProperty("yql.path"),publicPath:a.getProperty("yql.public.path"),store:a.getProperty("yql.store"),crumb:a.getProperty("yql.crumb"),env:a.getProperty("yql.env")};V=a.getProperty("fbauthstate");b=a.getProperty("login.fb.url");G=(V===H||V===E);if(!R){J({});R=f.one("body");R.delegate(I,s,m,this);}return j;},updateFBAccessToken:z,onFBConnectSuccess:P,onCookieRefresh:g,onYSignIn:K};if(e){e.registerService(f[B][N]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("interests_service",function(b){var i="MPServices",d="InterestsProvider",e=true,f=null,j=b.guid(),g="interests_service|",h="interests:change",c={},k=f;function a(){b.Global.detachAll(g+"*");b.Global.on(g+h,this._onInterestsChange,this);}a.prototype={_fireWithOrigin:function(l,n){var m={origin:j,data:n};this.fire(l,m);},_onInterestsChange:function(l){if(l.origin!==j){this.set(l.data);}},get:function(n,m){var o,l={};b.Array.each(n||b.Object.keys(c),function(p){o=b.Object.owns(c,p)?b.merge(c[p]):f;if(o&&(!m||m(o,p))){l[p]=o;}});return l;},getById:function(l){return this.get([l])[l]||f;},set:function(m){var l={};b.Object.each(m,function(n,o){this.update(o,n,e);l[o]=b.merge(c[o]);},this);this._fireWithOrigin(h,l);return this;},update:function(o,m,l){var n={};if(b.Object.owns(c,o)){b.mix(c[o],m,e);}else{m.id=o;c[o]=b.merge(m);}if(!l){n[o]=b.merge(c[o]);this._fireWithOrigin(h,n);}return this;}};b.augment(a,b.EventTarget,e,f,{broadcast:2,emitFacade:e});b.namespace(i)[d]={name:"interests",getService:function(m,l){if(!k){k=new a();}return k;}};if(b.ModulePlatform){b.ModulePlatform.registerService(b[i][d]);}},"0.0.1",{requires:["event-custom-base"]});/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
YUI.add("stream_action_drawer",function(Q){var W=null,J=true,v=false,aj="click",am=5*60*1000,at=2*24*60*60*1000,al=80,c="data-uuid",av="YPROP:SAVE",ao="height",U="MPServices",H="StreamSocialProvider",e=Q.ModulePlatform,h={LIKE:1,NEUTRAL:0,DISLIKE:-1},q=Q.Node.create('<span class="action-drawer-login"></span>'),k="like",aa="dislike",ah="saveforlater",D=".social-actions",a=".social-icon",G=".save-button",I=".check-button",L=".remove",j=".delete",m=G+","+I+","+L+","+j,Z=".saved,.liked,.disliked,.flagged",an=".entity",r=".entity-list",S=".entity-msg",t=".done-button",ak=".action-drawer-login",u="li",ab=".menu",R=".flag-content-item",ae="drawer-open",F="drawer-transition",ag="highline",ai="saved",X="liked",K="neutral",A="disliked",p="pos",ar="neu",ay="neg",s="flagged",n="put-update",au="delete-update",x="savedarticles",B="actionRestore",E="flagDetailsRestore",l="declareFeedback",z="removeStreamItem",d="onFlagDone",ad="recordFlag",O="deleteSaved",f="drawerToggleStart",ap="drawerToggleComplete",i="checked",P="input",g="saveforlater:newsaved",T="p_30345860",M="p_30345831",aq,N,w,C,V,ac,af,b,ax="",o=J,aw=0,y;y=function(Y){var az=W,aA=w.isLoggedIn();if(C&&!aA){C.getButtons(q,{sec:"td-strm-dr",layout:"horizontal",title:af.getString("STR.ACTIONDRAWER.LIKEDCTA"),narrow:1});C.configClick({selector:ak+" a",clickHandler:Q.bind(this.onLoginBtnClick,this)});}if(N){N.removeItem(x);az=N.getItem(B);if(az){if(aA){this.restoreAction(az);}N.removeItem(B);}}this.viewingSavedStories=ac?ac.isSflPage:v;this.flagContentEnabled=ac?ac.flagContentEnabled:v;this.sourceDeclarationEnabled=ac?ac.sourceDeclarationEnabled:v;this.timerInProcess=null;};y.prototype={disableButtons:function(){o=v;},restoreAction:function(az){var aA={},Y;if(az.type===ai){this.makeSaveRequest(n,az.uuid,J);aq.fireBeacon(az.beacon);}else{aq.fireBeacon(az.beacon);if(az.type===A){this.fire(z,{uuid:az.uuid,animate:v});aA={uuid:az.uuid,state:h.DISLIKE};}else{aA={uuid:az.uuid,state:h.LIKE};}this.fire(l,aA);Y=(az.type===X)?k:aa;this.markItemFeedbackInMixer(az.uuid,az.type,Y);}},handleSaveClick:function(aB){var aC=this.currentItem.hasClass(ai),aA,az=this.currentItem.getAttribute(c),Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",itc:1,action:aj});if(!aC||this.viewingSavedStories){if(this.viewingSavedStories){Y.slk="rm";Y.outcm="rmsvct";Y.rspns="rmct";}else{Y.slk="unsv";Y.outcm="unsvct";}aA=au;}else{Y.slk="sv";Y.outcm="svct";aA=n;Q.Global.fire(g);}aq.fireBeacon(Y);this.makeSaveRequest(aA,az);if(this.viewingSavedStories){if(o){this.closeDrawer(this.currentDrawer);}this.currentItem.remove();this.fire(O,{});}},handleLikeClick:function(aA){var aD=this.currentItem.hasClass(X),az=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aC=aD?"1":"0",aB=az?"-1":aD?"0":"1";if(!o){this.currentItem.removeClass(A);if(this.currentDrawer){this.currentDrawer.removeClass(A);if(aD){this.currentDrawer.addClass(X);}else{this.currentDrawer.removeClass(X);}}}this.fireItemInterestChange(aC,aB,X);this.markItemFeedbackInMixer(Y,aD?X:K,k);if(az){this.markItemFeedbackInMixer(Y,K,aa);}if(!aD){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);}},handleDislikeClick:function(aA){var aD=this.currentItem.hasClass(X),az=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aC=az?"-1":"0",aB=aD?"1":az?"0":"-1";if(!o){this.currentItem.removeClass(X);if(this.currentDrawer){this.currentDrawer.removeClass(X);if(az){this.currentDrawer.addClass(A);}else{this.currentDrawer.removeClass(A);}}}this.fireItemInterestChange(aC,aB,A);this.markItemFeedbackInMixer(Y,az?A:K,aa);if(aD){this.markItemFeedbackInMixer(Y,K,k);}if(!az){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}},handleFlagClick:function(aA){var az=this.currentItem.hasClass(s),Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",elm:"btn",elmt:"flag",itc:1,intl:ac.intl,action:aj});if(this.currentDrawer){if(az){this.currentDrawer.addClass(s);}else{this.currentDrawer.removeClass(s);}}if(!az){Y.slk="unflag";Y.outcm="unflagitm";Y.rspns="clps";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:v});});if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(X)){this.buildEntityList(J);}else{if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(A)){this.buildEntityList(J);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}}if(o){this.closeDrawer(this.currentDrawer);}}else{Y.slk="flag";Y.outcm="flagitm";Y.rspns="xpnd";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:J});});this.buildFlagEntityList();}aq.fireBeacon(Y);},markItemFeedbackInMixer:function(Y,aA,az){if(!ac.writeMixerActions||!w.isLoggedIn()){return;}if(!ax&&ac.listId){ax="LISTID:"+ac.listId;}this.makeInterestRequest({_subAction:"article_feedback",uuid:Y,state:aA,mixerAction:az,curFilter:ax});},updateConfirmationMsg:function(az){var Y=this.currentDrawer.one(S);if(Y){Y.setHTML(az);}},buildEntityList:function(aN){var aH=o?af.getString("STR.ENTITY.LIST.TEMPLATE"):af.getString("STR.REMOVE.MENU"),aP=af.getString("STR.ENTITY.ITEM.TEMPLATE"),aO="",az,Y,aD,aL=this.currentDrawer.one(S),aE=this.currentDrawer.one(r),aJ=this.currentDrawer.one(t),aG=this.currentDrawer.one(ab),aA,aM="",aB={},aK,aC=J,aQ=0,aF=this.currentDrawer,aI=this;if(aE&&aJ&&aL){aE.remove();aJ.remove();aL.remove();}if(aG){aG.remove();}aA=V.get(this.currentItem.getAttribute("data-wikiids").split("|"));Q.Object.each(aA,function(aR){aB={state:(aR.state===1)?p:(aR.state===-1)?ay:ar,type:aR.declared?"declared":"inferred",id:aR.id,name:aR.name};aM+=Q.Lang.sub(aP,aB);});if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aF.removeClass("dn");}if(this.sourceDeclarationEnabled){aD=this.currentItem.getAttribute("data-sourceid");if(aD){aO=af.getString("STR.SOURCE.ITEM.TEMPLATE");Y=V.getById(aD);az={state:Y?((Y.state===1)?p:((Y.state===-1)?ay:ar)):ar,id:aD,name:Y.name};aO=Q.Lang.sub(aO,az);}}if(Q.Object.size(aA)>0){aM=Q.Lang.sub(aH,{source:aO,entities:aM});aF.append(aM);if(o){aF.one(D).setStyle(ao,al+"px");aK=al+aF.one(r).get("clientHeight")+aF.one(t).get("clientHeight")+aF.one(S).get("clientHeight")+30;}else{aF.all(an).addClass("d-ib");aK=aF.one(ab).get("offsetHeight");aJ=aF.one(t);}aC=v;}else{if(!aN){if(o){aF.one(D).remove();}aM=af.getString("STR.ACTIONDRAWER.NOENTITIESLIKE");aF.append(aM);aK=aF.one(".no-entities").get("clientHeight");aC=v;aQ=aF.hasClass(A)?0:3000;this.timerInProcess=Q.later(aQ,this,function(){if(aI.currentDrawer===aF){aI.closeDrawer(aF,ac.nonPersonalStream);}});if(aF.hasClass(A)){aF.addClass("dn");this.currentItem.removeClass(ae);return aC;}}}aF.transition({height:aK+"px",duration:0.3,easing:"ease-in",on:{start:function(){aI.fire(f,{item:aI.currentItem});},end:function(){aI.fire(ap,{item:aI.currentItem});if(aJ){aJ.removeClass("dn");}aI.repaint();}}});return aC;},showLoginBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var az=this.currentItem.hasClass(ai)?af.getString("STR.ACTIONDRAWER.SAVEDCTA"):this.currentItem.hasClass(X)?af.getString("STR.ACTIONDRAWER.LIKEDCTA"):this.currentItem.hasClass(s)?af.getString("STR.ACTIONDRAWER.FLAGGEDCTA"):af.getString("STR.ACTIONDRAWER.DISLIKEDCTA"),aC,Y=this.currentDrawer.one(ak),aA,aE,aD,aB=this;if(Y){Y.remove();}Y=this.currentDrawer.appendChild(q.cloneNode(J));if(this.currentItem.hasClass(A)){aC=Y.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));}aD=this.currentDrawer.one(".title");if(aD){aD.setHTML(az);if(o){this.currentDrawer.one(D).setStyle(ao,al+"px");aA=al+this.currentDrawer.one(".embed").get("clientHeight");if(aC){aA+=(aC.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");aA=this.currentDrawer.one(".embed").get("offsetHeight");if(this.currentItem.hasClass(X)||this.currentItem.hasClass(A)){aE=this.currentItem.hasClass(X);this.fireItemInterestChange(aE?"1":"-1","0",aE?X:A);}}this.currentDrawer.transition({height:aA+"px",duration:0.3,easing:"ease-in",on:{start:function(){aB.fire(f,{item:aB.currentItem});},end:function(){aB.fire(ap,{item:aB.currentItem});aB.repaint();}}});}},onLoginBtnClick:function(Y){var aB=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",action:aj}),aA=this.currentItem.getAttribute(c),az;if(this.currentItem.hasClass(X)){az=X;aB.slk="neu-pos";aB.outcome="itemdecl";}else{if(this.currentItem.hasClass(A)){az=A;aB.slk="neu-neg";aB.outcome="itemdecl";}else{if(this.currentItem.hasClass(ai)){az=ai;aB.slk="sv";aB.outcome="svct";}else{if(this.currentItem.hasClass(s)){az=s;aB.slk="flag";aB.outcome="flagitm";}}}}N.setItem(B,{type:az,uuid:aA,beacon:aB},am);},onDoneClick:function(Y){aq.fireBeacon({sec:"td-strm-dr",slk:"btn-dn",itc:1,action:aj});this.closeDrawer(this.currentDrawer);},onFilter:function(Y){this.currentItem=W;this.currentDrawer=W;ax=Y.category;this.viewingSavedStories=v;if(ax===av){this.viewingSavedStories=J;}},populateHighlineMenu:function(){var aA=this.currentItem.getAttribute("data-highline-id"),az={id:encodeURIComponent(aA)},Y=this.currentDrawer.all("a");Y.each(function(aB){aB.setAttribute("href",Q.Lang.sub(aB.getAttribute("data-base-url"),az));});},onEntityClick:function(aI){var aC=aI.target,aH=aC.ancestor(an,J),aA=aH.getAttribute("data-interestid"),aF=aH.hasClass(p)?h.LIKE:aH.hasClass(ay)?h.DISLIKE:h.NEUTRAL,aB=aH.hasClass("inferred")?"inferred":"declared",Y,aD=aH.hasClass("source"),az={},aE={},aG={};if(this.currentDrawer.hasClass(X)&&!aH.hasClass(p)){aH.addClass(p);aH.removeClass(ar).removeClass(ay);Y=h.LIKE;}else{if(this.currentDrawer.hasClass(A)&&!aH.hasClass(ay)){aH.addClass(ay);aH.removeClass(ar).removeClass(p);Y=h.DISLIKE;}else{aH.addClass(ar);aH.removeClass(p).removeClass(ay);Y=h.NEUTRAL;}}aG={"new":Y.toString(),current:aF.toString(),type:"entity",id:aA};if(aD){aG.source=1;}this.fire(l,{interestObj:aG,item:this.currentItem,markFeedback:v});az={"new":Y,current:aF,type:aB};if(aD){az.name=aH.get("text");}aE[aA]=az;this.makeInterestRequest({_subAction:"int_manage",interest:aE});V.update(aA,{state:Y});},toggleDrawer:function(aH,aC,aA){var aE=w.isLoggedIn(),aD="",aI,aF=J,Y,aG=aH.get("nextSibling"),aJ=this,aB=this.currentItem&&this.currentItem.hasClass(ae)&&aH!==this.currentItem,az={sec:"td-strm-ctrl",itc:1,action:aj};if(aG&&aG.hasClass("flag-thankyou-msg-drawer")){aG.remove();}if(aB){this.closeDrawer(this.currentDrawer,true);}this.currentItem=aH;Y=this.currentItem.getAttribute(c);if(!aC&&this.currentItem&&!this.currentItem.hasClass(ae)){if(o){if(this.viewingSavedStories){aD=af.getString("STR.SAVE.BTN.TEMPLATE");}else{if(aH.hasClass(ag)){aD=af.getString("STR.HIGHLINE.BTN.TEMPLATE");}else{aD=af.getString("STR.SHARE.BTN.TEMPLATE");}}}aI='<li class="action-drawer y-pattern">'+aD+"</li>";this.currentItem.insert(aI,"after");this.currentDrawer=this.currentItem.get("nextSibling");if(o){this.currentDrawer.one(D).removeClass("v-h").removeClass("closed");this.actionBtnListner=this.currentDrawer.delegate(aj,this.onActionDrawerClick,m,this);}if(this.flagContentEnabled){this.flagItemListner=this.currentDrawer.delegate("change",this.onFlagItemClick,R+" "+P,this);}this.entityListner=this.currentDrawer.delegate(aj,this.onEntityClick,an,this);this.doneBtnListner=this.currentDrawer.delegate(aj,this.onDoneClick,t,this);if(!this.viewingSavedStories&&(o||aE)){if(aA){this.currentDrawer.addClass(aA);}else{if(this.currentItem.hasClass(ai)){this.currentDrawer.addClass(ai);}if(this.currentItem.hasClass(X)){this.currentDrawer.addClass(X);if(o){aF=this.buildEntityList(J);}}if(this.currentItem.hasClass(A)){this.currentDrawer.addClass(A);if(o){aF=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(s)){this.currentDrawer.addClass(s);if(o){this.buildFlagEntityList();}}}if(this.currentItem.hasClass(ag)){this.currentDrawer.addClass(ag);this.populateHighlineMenu();}}else{if(!o&&!aE){aF=v;}}if(aF&&o){this.currentDrawer.transition({height:al+"px",duration:0.3,easing:"ease-in",on:{start:function(){aJ.currentDrawer.addClass(F);},end:function(){aJ.currentDrawer.removeClass(F);}}});Q.config.win.scrollTo(0,aJ.currentItem.getY()-aw);}this.currentItem.addClass(ae);if(!o){this.currentDrawer.addClass("dn");}az.rspns="xpnd";}else{if(!aC&&this.currentItem&&this.currentItem.hasClass(ae)){this.closeDrawer(this.currentDrawer);this.currentDrawer=W;az.rspns="clps";if(o){this.actionBtnListner.detach();}this.entityListner.detach();this.doneBtnListner.detach();if(this.flagContentEnabled){this.flagItemListner.detach();}}}if(o){az.slk="btn-dr";aq.fireBeacon(az);}},closeDrawer:function(aE,aA){var aF=w.isLoggedIn(),aD=this.currentItem,aB=this.currentDrawer,az=aE.one(t),Y=this,aC={};if(az){az.addClass("dn");}if(aD.hasClass(s)&&aB.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(d,{item:aD,drawer:aB,animate:J});});}if(aD.hasClass(A)){if(aD.hasClass(s)&&aB.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(z,{item:aD,animate:J,immediate:J});});}else{Q.later(300,this,function(){this.fire(z,{item:aD,animate:J,immediate:v});});}}if(!aF&&this.currentItem){aD.removeClass(ai).removeClass(X).removeClass(A).removeClass(s);}aC.start=function(){Y.fire(f,{item:aD});if(!aE.one(r)&&!aE.one(ak)){aE.addClass(F);}};aC.end=function(){Y.fire(ap,{item:aD});aE.remove();aD.removeClass(ae);if(!o){aD.removeClass("y-pattern").removeClass("hover");}Y.repaint();};if(aA){aC.start();aE.setStyle("height","0px");aC.end();}else{aE.transition({height:"0px",duration:0.3,easing:"default",on:aC});}},fireItemInterestChange:function(aA,az,Y){this.fire(l,{interestObj:{"new":aA,current:az,type:"content",action:Y},item:this.currentItem,markFeedback:v});},onActionDrawerClick:function(Y){var aB=Y.target,az=aB.ancestor(u),aA=aB.ancestor(a,J),aD=w.isLoggedIn(),aC;Y.preventDefault();if(aA.test(G)){az.toggleClass(ai);this.currentItem.toggleClass(ai);if(aD){this.handleSaveClick(aA);}else{az.removeClass(X).removeClass(A);this.currentItem.removeClass(X).removeClass(A);}}else{if(aA.test(j)){this.handleSaveClick(aA);}else{if(aA.test(I)){az.toggleClass(X);this.currentItem.toggleClass(X);if(aD){this.handleLikeClick(aA);}else{aC=az.hasClass(X);this.fireItemInterestChange(aC?"0":"1",aC?"1":"0",X);az.removeClass(ai).removeClass(A);this.currentItem.removeClass(ai).removeClass(A);}az.removeClass(A);this.currentItem.removeClass(A);}else{az.toggleClass(A);this.currentItem.toggleClass(A);if(aD){this.handleDislikeClick(aA);}else{aC=az.hasClass(A);this.fireItemInterestChange(aC?"0":"-1",aC?"-1":"0",A);az.removeClass(ai).removeClass(X);this.currentItem.removeClass(ai).removeClass(X);}az.removeClass(X);this.currentItem.removeClass(X);}}}if(!aD){if(this.currentDrawer.test(Z)&&(!ac.nonPersonalStream||!aA.test(L))){this.showLoginBtns();}else{this.closeDrawer(this.currentDrawer);}}},buildFlagEntityList:function(){var aK=this.currentDrawer,aA=this.currentItem.getAttribute(c),aL=this.currentDrawer.one(".flag-content-form"),aH=this.currentDrawer.one(S),aD=this.currentDrawer.one(r),aE=this.currentDrawer.one(t),az=this.currentDrawer.one(ab),aI=this.currentDrawer.one(".no-entities"),aG=N.getItem(E)||{},aB=[],aF,Y=0,aC=0,aJ=this;if(aD&&aE&&aH){aD.remove();aE.remove();aH.remove();}if(this.timerInProcess){this.timerInProcess.cancel();this.timerInProcess=null;if(this.currentDrawer){if(this.currentDrawer.hasClass(X)){this.currentDrawer.removeClass(X);this.currentItem.addClass(X);}}if(aI){aI.remove();}}if(az){az.remove();}if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aK.removeClass("dn");}aK.addClass(s);aF=af.getString("STR.ACTIONDRAWER.FLAGMENU");if(aF){aL=aK.append(aF);Y=120;}aB=aG[aA];if(aB&&aB.length>0){for(aC=0;aC<aB.length;aC++){aK.one('[value="'+aB[aC]+'"]').set("checked",true);}}this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{end:function(){aJ.repaint();}}});},onFlagItemClick:function(aC){var aE=aC.target,aB=aE.ancestor(R,J,ab),aD=aC.target.getAttribute("value"),aF=this.currentItem.getAttribute(c),aA=N.getItem(E)||{},az=[],Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-dr",slk:aB.get("text"),elm:"inpt",elmt:"flag",itc:1,intl:ac.intl,action:aj});az=aA[aF]||[];if(aE.get(i)){Y.outcm="flagcat";if(az.indexOf(aD)<0){az.push(aD);}}else{Y.outcm="unflagcat";if(az.indexOf(aD)>-1){az.splice(az.indexOf(aD),1);}}aA[aF]=az;N.setItem(E,aA,at);aq.fireBeacon(Y);},repaint:function(){var Y=this.currentItem?this.currentItem.get("parentNode"):W;if(Q.UA.ie&&Q.UA.ie<8&&Y){Y._node.className=Y._node.className;}},makeSaveRequest:function(az,Y){if(!ax&&ac.listId){ax="LISTID:"+ac.listId;}af.makeRequest({type:"module",moduleId:T,args:{_action:"save",_subAction:az,noups:1,uuid:Y,mixerAction:ah,curFilter:ax}},{});},makeInterestRequest:function(Y){b.makeRequest({type:"module",moduleId:M,args:Q.merge({_action:"show"},Y)},{});}};Q.augment(y,Q.EventTarget);Q.namespace(U);Q[U][H]={name:"stream_action_drawer",getService:function(aA,az){var Y;b=aA.getService("transport_helper",az);af=aA.getModuleApi(az);aq=aA.getService("instrumentation");N=aA.getService("storage");w=aA.getService("userinfo");C=aA.getService("login",az);V=af.getService("interests");ac=af.getContextData();if((!Q.UA.android||Q.UA.android>=3)){Y=Q.one(".banner-wrapper")||Q.one(".type_masthead")||Q.one(".type_mastheadlite")||Q.one(".yog-hd");if(Y){aw=Y.get("offsetHeight");}}return new y();}};if(e){e.registerService(Q[U][H]);}},"1.0");/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
(function(){var d=null,e=d,c=false,b="click",a="default";YModules.type_login={body:d,id:"",moduleapi:d,loginService:d,fbAppConfig:d,accessTokenRefresh:c,init:function(g){e=g.getService("yui");var f=g.getContextData();this.id=g.getId();this.moduleapi=g;this.loginService=g.getService("login");this.fbAppConfig={fbAppId:f.fbAppId,fbPerms:f.fbPerms};this.accessTokenRefresh=f.accessTokenRefresh;},onviewload:function(f){if(f===a){this.body=this.moduleapi.getViewNode(f);this.loginService.setupFBApp(this.fbAppConfig);if(this.accessTokenRefresh){e.later(5000,this,function(){this.loginService.updateFBAccessToken();});}}},onviewunload:function(f){if(f===a){this.body=d;}},onviewevent:function(g,f){if(g===a){if(f.type===b){this.onClick(f);}else{}}}};}());/* Copyright (c) 2014, Yahoo! Inc.  All rights reserved. */
